<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>17 - Fault Density Map · GeophysicalModelGenerator.jl</title><meta name="title" content="17 - Fault Density Map · GeophysicalModelGenerator.jl"/><meta property="og:title" content="17 - Fault Density Map · GeophysicalModelGenerator.jl"/><meta property="twitter:title" content="17 - Fault Density Map · GeophysicalModelGenerator.jl"/><meta name="description" content="Documentation for GeophysicalModelGenerator.jl."/><meta property="og:description" content="Documentation for GeophysicalModelGenerator.jl."/><meta property="twitter:description" content="Documentation for GeophysicalModelGenerator.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="GeophysicalModelGenerator.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeophysicalModelGenerator.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/">Overview</a></li><li><a class="tocitem" href="../Tutorial_Basic/">1 - Getting started</a></li><li><a class="tocitem" href="../tutorial_load3DSeismicData/">2 - 3D seismic tomography from ASCII</a></li><li><a class="tocitem" href="../tutorial_loadregular3DSeismicData_netCDF/">3 - 3D seismic tomography from netCDF</a></li><li><a class="tocitem" href="../Tutorial_MohoTopo_Spada/">4 - Visualize Moho topography</a></li><li><a class="tocitem" href="../tutorial_GMT_Topography/">5 - Create GMT-based topography</a></li><li><a class="tocitem" href="../tutorial_Coastlines/">6 - Coastlines</a></li><li><a class="tocitem" href="../tutorial_Screenshot_To_Paraview/">7 - Import screenshots</a></li><li><a class="tocitem" href="../tutorial_loadirregular3DSeismicData/">8 - Interpolate irregular 3D seismic tomography</a></li><li><a class="tocitem" href="../tutorial_GMT_Topography_GeologicalMap/">9 - ETOPO1 Topography and geological maps</a></li><li><a class="tocitem" href="../tutorial_ISC_data/">10 - ISC earthquake data</a></li><li><a class="tocitem" href="../tutorial_GPS/">11 - Plot GPS vectors</a></li><li><a class="tocitem" href="../tutorial_UTM/">12 - Read UTM data</a></li><li><a class="tocitem" href="../Tutorial_Votemaps/">13 - VoteMaps</a></li><li><a class="tocitem" href="../tutorial_local_Flegrei/">14 - Campi Flegrei</a></li><li><a class="tocitem" href="../Tutorial_LaPalma/">15 - La Palma volcano Model</a></li><li><a class="tocitem" href="../tutorial_time_Seismicity/">16 - Create movies</a></li><li class="is-active"><a class="tocitem" href>17 - Fault Density Map</a><ul class="internal"><li><a class="tocitem" href="#Goal"><span>Goal</span></a></li><li><a class="tocitem" href="#1.-Load-Data"><span>1. Load Data</span></a></li><li><a class="tocitem" href="#2.-Create-Density-Map"><span>2. Create Density Map</span></a></li></ul></li><li><a class="tocitem" href="../Tutorial_AlpineData/">18 - Alpine data integration</a></li><li><a class="tocitem" href="../Tutorial_Jura/">19 - Jura tutorial</a></li><li><a class="tocitem" href="../Tutorial_NumericalModel_2D/">20 - 2D model setups</a></li><li><a class="tocitem" href="../Tutorial_NumericalModel_3D/">21 - 3D model setups</a></li><li><a class="tocitem" href="../Tutorial_VolcanoModel_3D/">22 - 3D model setups</a></li><li><a class="tocitem" href="../tutorial_Polygon_structures/">23 - Build geometry from polygons</a></li></ul></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../datastructures/">Data Structures</a></li><li><a class="tocitem" href="../dataimport/">Data Import</a></li><li><a class="tocitem" href="../projection/">Projection</a></li><li><a class="tocitem" href="../asagi_io/">ASAGI</a></li><li><a class="tocitem" href="../paraview_output/">Paraview output</a></li><li><a class="tocitem" href="../paraview_collection/">Paraview collection</a></li><li><a class="tocitem" href="../surfaces/">Surfaces</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><a class="tocitem" href="../visualise/">Visualisation</a></li><li><a class="tocitem" href="../gravity_code/">Gravity code</a></li><li><a class="tocitem" href="../geodynamic_setups/">Numerical model setups</a></li><li><a class="tocitem" href="../lamem/">LaMEM</a></li><li><a class="tocitem" href="../ptatin/">pTatin</a></li><li><a class="tocitem" href="../Tutorial_Chmy_MPI/">Chmy</a></li><li><a class="tocitem" href="../profile_processing/">Profile Processing</a></li><li><a class="tocitem" href="../gmsh/">Gmsh</a></li><li><a class="tocitem" href="../movies/">Movies</a></li></ul></li><li><a class="tocitem" href="../listfunctions/">List of functions</a></li><li><a class="tocitem" href="../authors/">Authors</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>17 - Fault Density Map</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>17 - Fault Density Map</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/main/tutorials/Tutorial_FaultDensity.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Fault-Density-Map"><a class="docs-heading-anchor" href="#Fault-Density-Map">Fault Density Map</a><a id="Fault-Density-Map-1"></a><a class="docs-heading-anchor-permalink" href="#Fault-Density-Map" title="Permalink"></a></h1><h2 id="Goal"><a class="docs-heading-anchor" href="#Goal">Goal</a><a id="Goal-1"></a><a class="docs-heading-anchor-permalink" href="#Goal" title="Permalink"></a></h2><p>In this tutorial, Fault Data is loaded as Shapefiles, which is then transformed to raster data. With the help of that a fault density map of Europe is created.</p><h2 id="1.-Load-Data"><a class="docs-heading-anchor" href="#1.-Load-Data">1. Load Data</a><a id="1.-Load-Data-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Load-Data" title="Permalink"></a></h2><p>Load packages:</p><pre><code class="language-julia hljs">using GeophysicalModelGenerator, Shapefile, Plots, Rasters, GeoDatasets, Interpolations</code></pre><p>Data is taken from &quot;Active Faults of Eurasia Database AFEAD v2022&quot; DOI:10.13140/RG.2.2.25509.58084 You need to download it manually (as it doesn&#39;t seem to work automatically), and can load the following file:</p><pre><code class="language-julia hljs">File   = &quot;AFEAD_v2022/AFEAD_v2022.shp&quot;</code></pre><p>Load data using the <code>Shapefile</code> package:</p><pre><code class="language-julia hljs">table  = Shapefile.Table(File)
geoms  = Shapefile.shapes(table)
CONF   = table.CONF</code></pre><p>Raster the shapefile data</p><pre><code class="language-julia hljs">ind    = findall((table.CONF .== &quot;A&quot;) .| (table.CONF .== &quot;B&quot;) .| (table.CONF .== &quot;C&quot;))
faults = Shapefile.Handle(File).shapes[ind]
faults = rasterize(last,faults; res=(0.12,0.12), missingval=0, fill=1, atol = 0.4, shape=:line)
lon    = faults.dims[1]
lat    = faults.dims[2]</code></pre><p>Download coastlines with <code>GeoDatasets</code>:</p><pre><code class="language-julia hljs">lonC,latC,dataC = GeoDatasets.landseamask(;resolution=&#39;l&#39;,grid=10)</code></pre><p>Interpolate to fault grid</p><pre><code class="language-julia hljs">itp        = linear_interpolation((lonC, latC), dataC)
coastlines = itp[lon.val,lat.val]
coastlines = map(y -&gt; y &gt; 1 ? 1 : y, coastlines)</code></pre><p>Plot the fault data</p><pre><code class="language-julia hljs">heatmap(lon.val,lat.val,coastlines&#39;,legend=false,colormap=cgrad(:gray1,rev=true),alpha=0.4);
plot!(faults; color=:red,legend = false,title=&quot;Fault Map World&quot;,ylabel=&quot;Lat&quot;,xlabel=&quot;Lon&quot;)</code></pre><p><img src="../../assets/img/WorldMap.png" alt="tutorial_Fault_Map"/></p><p>Restrict area to Europe</p><pre><code class="language-julia hljs">indlat = findall((lat .&gt; 35) .&amp; (lat .&lt; 60))
Lat    = lat[indlat]
indlon = findall((lon .&gt; -10) .&amp; (lon .&lt; 35))
Lon    = lon[indlon]
data   = faults.data[indlon,indlat]</code></pre><p>Create GeoData from restricted data</p><pre><code class="language-julia hljs">Lon3D,Lat3D, Faults = lonlatdepth_grid(Lon,Lat,0);
Faults[:,:,1]       = data
Data_Faults         = GeoData(Lon3D,Lat3D,Faults,(Faults=Faults,))</code></pre><h2 id="2.-Create-Density-Map"><a class="docs-heading-anchor" href="#2.-Create-Density-Map">2. Create Density Map</a><a id="2.-Create-Density-Map-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Create-Density-Map" title="Permalink"></a></h2><p>Create a density map of the fault data. This is done with the <code>countmap</code> function. This function takes a specified field of a 2D <code>GeoData</code> struct and counts the entries in all control areas which are defined by steplon (number of control areas in lon direction) and steplat (number of control areas in lat direction). The field should only consist of 0.0 and 1.0 and the steplength. The final result is normalized by the highest count.</p><pre><code class="language-julia hljs">steplon  = 188
steplat  = 104
cntmap   = countmap(Data_Faults,&quot;Faults&quot;,steplon,steplat)</code></pre><p>Plot the density map with coastlines</p><pre><code class="language-julia hljs">lon = unique(cntmap.lon.val)
lat = unique(cntmap.lat.val)
coastlinesEurope = itp[lon,lat]
coastlinesEurope = map(y -&gt; y &gt; 1 ? 1 : y, coastlinesEurope)</code></pre><p>Plot this using <code>Plots.jl</code>:</p><pre><code class="language-julia hljs">heatmap(lon,lat,coastlinesEurope&#39;,colormap=cgrad(:gray1,rev=true),alpha=1.0);
heatmap!(lon,lat,cntmap.fields.countmap[:,:,1]&#39;,colormap=cgrad(:batlowW,rev=true),alpha = 0.8,legend=true,title=&quot;Fault Density Map Europe&quot;,ylabel=&quot;Lat&quot;,xlabel=&quot;Lon&quot;)</code></pre><p><img src="../../assets/img/FaultDensity.png" alt="tutorial_Fault_Map"/></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial_time_Seismicity/">« 16 - Create movies</a><a class="docs-footer-nextpage" href="../Tutorial_AlpineData/">18 - Alpine data integration »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Thursday 30 October 2025 09:04">Thursday 30 October 2025</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
