<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>14 - Campi Flegrei · GeophysicalModelGenerator.jl</title><meta name="title" content="14 - Campi Flegrei · GeophysicalModelGenerator.jl"/><meta property="og:title" content="14 - Campi Flegrei · GeophysicalModelGenerator.jl"/><meta property="twitter:title" content="14 - Campi Flegrei · GeophysicalModelGenerator.jl"/><meta name="description" content="Documentation for GeophysicalModelGenerator.jl."/><meta property="og:description" content="Documentation for GeophysicalModelGenerator.jl."/><meta property="twitter:description" content="Documentation for GeophysicalModelGenerator.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="GeophysicalModelGenerator.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeophysicalModelGenerator.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/">Overview</a></li><li><a class="tocitem" href="../Tutorial_Basic/">1 - Getting started</a></li><li><a class="tocitem" href="../tutorial_load3DSeismicData/">2 - 3D seismic tomography from ASCII</a></li><li><a class="tocitem" href="../tutorial_loadregular3DSeismicData_netCDF/">3 - 3D seismic tomography from netCDF</a></li><li><a class="tocitem" href="../Tutorial_MohoTopo_Spada/">4 - Visualize Moho topography</a></li><li><a class="tocitem" href="../tutorial_GMT_Topography/">5 - Create GMT-based topography</a></li><li><a class="tocitem" href="../tutorial_Coastlines/">6 - Coastlines</a></li><li><a class="tocitem" href="../tutorial_Screenshot_To_Paraview/">7 - Import screenshots</a></li><li><a class="tocitem" href="../tutorial_loadirregular3DSeismicData/">8 - Interpolate irregular 3D seismic tomography</a></li><li><a class="tocitem" href="../tutorial_GMT_Topography_GeologicalMap/">9 - ETOPO1 Topography and geological maps</a></li><li><a class="tocitem" href="../tutorial_ISC_data/">10 - ISC earthquake data</a></li><li><a class="tocitem" href="../tutorial_GPS/">11 - Plot GPS vectors</a></li><li><a class="tocitem" href="../tutorial_UTM/">12 - Read UTM data</a></li><li><a class="tocitem" href="../Tutorial_Votemaps/">13 - VoteMaps</a></li><li class="is-active"><a class="tocitem" href>14 - Campi Flegrei</a><ul class="internal"><li><a class="tocitem" href="#Goal"><span>Goal</span></a></li><li><a class="tocitem" href="#Steps"><span>Steps</span></a></li></ul></li><li><a class="tocitem" href="../Tutorial_LaPalma/">15 - La Palma volcano Model</a></li><li><a class="tocitem" href="../tutorial_time_Seismicity/">16 - Create movies</a></li><li><a class="tocitem" href="../Tutorial_FaultDensity/">17 - Fault Density Map</a></li><li><a class="tocitem" href="../Tutorial_AlpineData/">18 - Alpine data integration</a></li><li><a class="tocitem" href="../Tutorial_Jura/">19 - Jura tutorial</a></li><li><a class="tocitem" href="../Tutorial_NumericalModel_2D/">20 - 2D model setups</a></li><li><a class="tocitem" href="../Tutorial_NumericalModel_3D/">21 - 3D model setups</a></li><li><a class="tocitem" href="../Tutorial_VolcanoModel_3D/">22 - 3D model setups</a></li><li><a class="tocitem" href="../tutorial_Polygon_structures/">23 - Build geometry from polygons</a></li></ul></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../datastructures/">Data Structures</a></li><li><a class="tocitem" href="../dataimport/">Data Import</a></li><li><a class="tocitem" href="../projection/">Projection</a></li><li><a class="tocitem" href="../asagi_io/">ASAGI</a></li><li><a class="tocitem" href="../paraview_output/">Paraview output</a></li><li><a class="tocitem" href="../paraview_collection/">Paraview collection</a></li><li><a class="tocitem" href="../surfaces/">Surfaces</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><a class="tocitem" href="../visualise/">Visualisation</a></li><li><a class="tocitem" href="../gravity_code/">Gravity code</a></li><li><a class="tocitem" href="../geodynamic_setups/">Numerical model setups</a></li><li><a class="tocitem" href="../lamem/">LaMEM</a></li><li><a class="tocitem" href="../ptatin/">pTatin</a></li><li><a class="tocitem" href="../Tutorial_Chmy_MPI/">Chmy</a></li><li><a class="tocitem" href="../profile_processing/">Profile Processing</a></li><li><a class="tocitem" href="../gmsh/">Gmsh</a></li><li><a class="tocitem" href="../movies/">Movies</a></li></ul></li><li><a class="tocitem" href="../listfunctions/">List of functions</a></li><li><a class="tocitem" href="../authors/">Authors</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>14 - Campi Flegrei</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>14 - Campi Flegrei</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/main/docs/src/man/tutorial_local_Flegrei.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Campi-Flegrei-Volcano-tutorial-using-Cartesian-coordinates"><a class="docs-heading-anchor" href="#Campi-Flegrei-Volcano-tutorial-using-Cartesian-coordinates">Campi Flegrei Volcano tutorial using Cartesian coordinates</a><a id="Campi-Flegrei-Volcano-tutorial-using-Cartesian-coordinates-1"></a><a class="docs-heading-anchor-permalink" href="#Campi-Flegrei-Volcano-tutorial-using-Cartesian-coordinates" title="Permalink"></a></h1><h2 id="Goal"><a class="docs-heading-anchor" href="#Goal">Goal</a><a id="Goal-1"></a><a class="docs-heading-anchor-permalink" href="#Goal" title="Permalink"></a></h2><p>This tutorial visualizes available 3D data at a local volcano (Campi Flegrei caldera, Italy) using Cartesian coordinates. This is done, e.g., when we only have geomorphological data in Cartesian coordinates. It includes geological and geophysical data in UTM format from the following papers:</p><ul><li><p>Two shape files containing coastline and faults:</p><ul><li>Vilardo, G., Ventura, G., Bellucci Sessa, E. and Terranova, C., 2013. Morphometry of the Campi Flegrei caldera (southern Italy). Journal of maps, 9(4), pp.635-640. doi:10.1080/17445647.2013.842508</li></ul></li><li><p>Earthquake data for two volcanic unrests, in 1983-84 and 2005-2016:</p><ul><li><p>De Siena, L., Chiodini, G., Vilardo, G., Del Pezzo, E., Castellano, M., Colombelli, S., Tisato, N. and Ventura, G., 2017. Source and dynamics of a volcanic caldera unrest: Campi Flegrei, 1983–84. Scientific reports, 7(1), pp.1-13. doi:10.1038/s41598-017-08192-7</p></li><li><p>De Siena, L., Sammarco, C., Cornwell, D.G., La Rocca, M., Bianco, F., Zaccarelli, L. and Nakahara, H., 2018. Ambient seismic noise image of the structurally controlled heat and fluid feeder pathway at Campi Flegrei caldera. Geophysical Research Letters, 45(13), pp.6428-6436. doi:10.1029/2018GL078817</p></li></ul></li><li><p>Travel time tomography model:</p><ul><li>Battaglia, Jean, Aldo Zollo, Jean Virieux, and Dario Dello Iacono, 2008. Merging active and passive data sets in traveltime tomography: the case study of Campi Flegrei caldera (Southern Italy). Geophysical Prospecting 56, no. 4: 555-573.  doi:10.1111/j.1365-2478.2007.00687.x</li></ul></li><li><p>Ambient noise tomography model:</p><ul><li>Battaglia, Jean, Aldo Zollo, Jean Virieux, and Dario Dello Iacono, 2008. Merging active and passive data sets in traveltime tomography: the case study of Campi Flegrei caldera (Southern Italy). Geophysical Prospecting 56, no. 4: 555-573.  doi:10.1111/j.1365-2478.2007.00687.x</li></ul></li></ul><h2 id="Steps"><a class="docs-heading-anchor" href="#Steps">Steps</a><a id="Steps-1"></a><a class="docs-heading-anchor-permalink" href="#Steps" title="Permalink"></a></h2><h4 id="1.-Download-all-data-for-region"><a class="docs-heading-anchor" href="#1.-Download-all-data-for-region">1. Download all data for region</a><a id="1.-Download-all-data-for-region-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Download-all-data-for-region" title="Permalink"></a></h4><p>You will need to download the zipped folder containing all files from <a href="https://seafile.rlp.net/f/ff2c8424274c4d56b1f7/">here</a>.</p><p>Make sure that you are in the unzipped directory.</p><h4 id="2.-Geomorphology"><a class="docs-heading-anchor" href="#2.-Geomorphology">2. Geomorphology</a><a id="2.-Geomorphology-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Geomorphology" title="Permalink"></a></h4><p>Load both the the shape (.shp) files contained in <code>./Geomorphology/*.shp</code> inside Paraview. In the following figures we show the Cartesian representation (not geolocalized - left) and the UTM (UTM). Our shape files can only be loaded in the Cartesian:</p><p><img src="../../assets/img/Flegrei_Geomorphology.png" alt="Tutorial_Flegrei_Geomorphology"/></p><p>To reproduce it, represent the coastline as data points with black solid color and assign your favourite color map to the morphology. Note that each block color number corresponds to a different morphology. Beware that this file only works in Cartesian coordinate, as it is still impossible to generate shape files in real UTM coordinates</p><h4 id="3.-Earthquakes"><a class="docs-heading-anchor" href="#3.-Earthquakes">3. Earthquakes</a><a id="3.-Earthquakes-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Earthquakes" title="Permalink"></a></h4><p>Now let&#39;s plot earthquake data provided as text files. Start loading the data contained in <code>./SeismicLocations/*.txt</code>. The first column gives us a temporal marker we can use to plot earthquakes in different periods.</p><pre><code class="language-julia hljs">julia&gt; using DelimitedFiles, GeophysicalModelGenerator, Glob, GeoStats
julia&gt; data_80s            = readdlm(&quot;SeismicLocations/Seismicity_UTM_1983_1984.txt&quot;, &#39;\t&#39;, skipstart=0, header=false);
julia&gt; data_00s            = readdlm(&quot;SeismicLocations/Seismicity_UTM_2005_2016.txt&quot;, &#39; &#39;, skipstart=0, header=false);
julia&gt; data                = vcat(data_80s,data_00s)        
julia&gt; time                = data[:,1];
julia&gt; WE                  = data[:,2];
julia&gt; SN                  = data[:,3];
julia&gt; depth               = data[:,4];
julia&gt; EQ_Data_Cart        = CartData(WE,SN,depth,(Depth=depth * m,Time=time * yr,));
julia&gt; write_paraview(EQ_Data_Cart, &quot;CF_Earthquakes_Cartesian&quot;, PointsData=true)
julia&gt; EQ_Data_UTM         = UTMData(WE, SN, depth, 33, true, (Depth=depth * m,Time=time * yr,));
julia&gt; Data_set_UTM        =   convert(GeophysicalModelGenerator.GeoData,EQ_Data_UTM)
julia&gt; write_paraview(Data_set_UTM, &quot;CF_Earthquakes_UTM&quot;, PointsData=true)</code></pre><p>Save in paraview with both Cartesian and UTM formats. The final seismicity map looks like this:</p><p><img src="../../assets/img/Flegrei_Seismicity.png" alt="Tutorial_Flegrei_seismicity"/></p><p>The colour scale distinguishes earthquakes of different decades. Notice the progressive migration of recent seismicity (black dots) towards East.</p><h4 id="4.-Velocity-model"><a class="docs-heading-anchor" href="#4.-Velocity-model">4. Velocity model</a><a id="4.-Velocity-model-1"></a><a class="docs-heading-anchor-permalink" href="#4.-Velocity-model" title="Permalink"></a></h4><p>Using the Alps tutorial it is easy to create a paraview file from the Vp, Vs and Vp/Vs model in <code>./TravelTmeTomography/modvPS.dat</code> for both Cartesian and UTM coordinates.</p><pre><code class="language-julia hljs">julia&gt; using DelimitedFiles, GeophysicalModelGenerator
julia&gt; data            =   readdlm(&quot;TravelTimeTomography/modvPS.dat&quot;, &#39;\t&#39;, Float64, skipstart=0, header=false);
julia&gt; WE              =   data[:,1];
julia&gt; SN              =   data[:,2];
julia&gt; depth           =   data[:,3];
julia&gt; Vp              =   data[:,4];
julia&gt; Vs              =   data[:,5];
julia&gt; VpVs            =   data[:,6];
julia&gt; resolution      =   (length(unique(depth)),  length(unique(SN)), length(unique(WE)))
julia&gt; dim_perm        =   [3 2 1]
julia&gt; we              =   permutedims(reshape(WE, resolution), dim_perm);
julia&gt; sn              =   permutedims(reshape(SN, resolution), dim_perm);
julia&gt; depth           =   permutedims(reshape(depth, resolution), dim_perm);
julia&gt; Vp3d            =   permutedims(reshape(Vp, resolution), dim_perm);
julia&gt; Vs3d            =   permutedims(reshape(Vs, resolution), dim_perm);
julia&gt; Vp_Vs3d         =   permutedims(reshape(VpVs, resolution), dim_perm);
julia&gt; Data_set_Cartesian  =   CartData(we, sn, depth, (vp = Vp3d * (km / s), vs = Vs3d * (km / s), vpvs = Vp_Vs3d,))
julia&gt; write_paraview(Data_set_Cartesian, &quot;CF_Velocity_Cartesian&quot;)
julia&gt; Data_set        =   UTMData(we, sn, depth, 33, true, (vp = Vp3d * (km / s), vs = Vs3d * (km / s), vpvs = Vp_Vs3d,))
julia&gt; Data_set_UTM    =   convert(GeophysicalModelGenerator.GeoData,Data_set)
julia&gt; write_paraview(Data_set_UTM, &quot;CF_Velocity_UTM&quot;)</code></pre><p>Including the Vp/Vs model in the previous Paraview file workspace:</p><p><img src="../../assets/img/Flegrei_VpVs.png" alt="Tutorial_Flegrei_VpVs"/></p><h4 id="5.-Horizontal-slices-of-shear-velocity-on-irregular-grid"><a class="docs-heading-anchor" href="#5.-Horizontal-slices-of-shear-velocity-on-irregular-grid">5. Horizontal slices of shear velocity on irregular grid</a><a id="5.-Horizontal-slices-of-shear-velocity-on-irregular-grid-1"></a><a class="docs-heading-anchor-permalink" href="#5.-Horizontal-slices-of-shear-velocity-on-irregular-grid" title="Permalink"></a></h4><p>Using ambient noise you can map shear wave velocity at different depths. The models at each depth are contained in the files <code>./NoiseTomography/*.txt</code>. We read them consecutively in a &quot;for&quot; loop:</p><pre><code class="language-julia hljs">julia&gt; list_files = glob(&quot;AmbientNoiseTomography/*.txt&quot;);
julia&gt; li         = size(list_files, 1);
julia&gt; for i = 1:li
          nameFile   = list_files[i];
          name_vts   = name_vts[24:26];
          data       = readdlm(nameFile, &#39;\t&#39;, Float64);
          WE         = data[:,1];
          SN         = data[:,2];
          depth      = data[:,3];
          Vs         = data[:,4];</code></pre><p>However these models are too wide, so it is better to constrain them:</p><pre><code class="language-julia hljs">         findall( (WE .&gt;= 419000) .&amp; (WE.&lt;=435000) .&amp; (SN.&gt;=4514000) .&amp; (SN.&lt;=4528000) );
         WE       = WE[ind];
         SN       = SN[ind];
         depth    = depth[ind];
         Vs       = Vs[ind];</code></pre><p>Also, nodes are irregular, hence we create a 3D regular UTM:</p><pre><code class="language-julia hljs">        l                = length(WE);
        n_WE             = minimum(WE):100:maximum(WE);
        n_SN             = minimum(SN):100:maximum(SN);
        we, sn, Depth    = xyz_grid(n_WE, n_SN, depth[1]);
        Vs_3D            = zeros(size(Depth));
        Cgrid            = GeoStats.CartesianGrid((size(we, 1), size(we, 2)), (minimum(we), minimum(sn)), (we[2,2,1] - we[1,1,1], sn[2,2,1] - sn[1,1,1]))
        coord            = PointSet([WE[:]&#39;; SN[:]&#39;]);
        Geo              = georef((Vs = Vs[:],), coord);
        P                = EstimationProblem(Geo, Cgrid, :Vs);
        S                = IDW(:Vs =&gt; (;neighbors=2));
        sol              = solve(P, S);
        sol_Vs           = values(sol).Vs;
        Vs_2D            = reshape(sol_Vs, size(domain(sol)));
        Vs_3D[:,:,1]     = Vs_2D;
        Data_set_Cart    = CartData(we, sn, Depth, (Vs = Vs_3D  * (km / s),))
        write_paraview(Data_set_Cart, &quot;CF_Noise&quot; * name_vts * &quot;_Cartesian&quot;)
        Data_set         = UTMData(we, sn, Depth, 33, true, (Vs = Vs_3D*(km / s),));
        Data_set_UTM     = convert(GeophysicalModelGenerator.GeoData, Data_set);
        write_paraview(Data_set_UTM, &quot;CF_Noise_UTM_&quot;*name_vts)
    end</code></pre><p>This is one of the horizontal sections created by the code in the previous model in both reference systems:</p><p><img src="../../assets/img/Flegrei_Noise.png" alt="Tutorial_Flegrei_Noise"/></p><p>If you want to run the entire example, you can find the .jl code <a href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/main/tutorial/Tutorial_Flegrei.jl">here</a></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Tutorial_Votemaps/">« 13 - VoteMaps</a><a class="docs-footer-nextpage" href="../Tutorial_LaPalma/">15 - La Palma volcano Model »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 30 January 2026 10:12">Friday 30 January 2026</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
