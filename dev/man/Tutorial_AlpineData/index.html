<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>18 - Alpine data integration · GeophysicalModelGenerator.jl</title><meta name="title" content="18 - Alpine data integration · GeophysicalModelGenerator.jl"/><meta property="og:title" content="18 - Alpine data integration · GeophysicalModelGenerator.jl"/><meta property="twitter:title" content="18 - Alpine data integration · GeophysicalModelGenerator.jl"/><meta name="description" content="Documentation for GeophysicalModelGenerator.jl."/><meta property="og:description" content="Documentation for GeophysicalModelGenerator.jl."/><meta property="twitter:description" content="Documentation for GeophysicalModelGenerator.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="GeophysicalModelGenerator.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeophysicalModelGenerator.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/">Overview</a></li><li><a class="tocitem" href="../Tutorial_Basic/">1 - Getting started</a></li><li><a class="tocitem" href="../tutorial_load3DSeismicData/">2 - 3D seismic tomography from ASCII</a></li><li><a class="tocitem" href="../tutorial_loadregular3DSeismicData_netCDF/">3 - 3D seismic tomography from netCDF</a></li><li><a class="tocitem" href="../Tutorial_MohoTopo_Spada/">4 - Visualize Moho topography</a></li><li><a class="tocitem" href="../tutorial_GMT_Topography/">5 - Create GMT-based topography</a></li><li><a class="tocitem" href="../tutorial_Coastlines/">6 - Coastlines</a></li><li><a class="tocitem" href="../tutorial_Screenshot_To_Paraview/">7 - Import screenshots</a></li><li><a class="tocitem" href="../tutorial_loadirregular3DSeismicData/">8 - Interpolate irregular 3D seismic tomography</a></li><li><a class="tocitem" href="../tutorial_GMT_Topography_GeologicalMap/">9 - ETOPO1 Topography and geological maps</a></li><li><a class="tocitem" href="../tutorial_ISC_data/">10 - ISC earthquake data</a></li><li><a class="tocitem" href="../tutorial_GPS/">11 - Plot GPS vectors</a></li><li><a class="tocitem" href="../tutorial_UTM/">12 - Read UTM data</a></li><li><a class="tocitem" href="../Tutorial_Votemaps/">13 - VoteMaps</a></li><li><a class="tocitem" href="../tutorial_local_Flegrei/">14 - Campi Flegrei</a></li><li><a class="tocitem" href="../Tutorial_LaPalma/">15 - La Palma volcano Model</a></li><li><a class="tocitem" href="../tutorial_time_Seismicity/">16 - Create movies</a></li><li><a class="tocitem" href="../Tutorial_FaultDensity/">17 - Fault Density Map</a></li><li class="is-active"><a class="tocitem" href>18 - Alpine data integration</a><ul class="internal"><li><a class="tocitem" href="#Goal"><span>Goal</span></a></li><li><a class="tocitem" href="#1.-Surface-Topography"><span>1. Surface Topography</span></a></li><li><a class="tocitem" href="#2.-Moho-topography"><span>2. Moho topography</span></a></li><li><a class="tocitem" href="#3.-Seismicity"><span>3. Seismicity</span></a></li><li><a class="tocitem" href="#4.-GPS-data"><span>4. GPS data</span></a></li><li><a class="tocitem" href="#5.-Seismic-tomography-data"><span>5. Seismic tomography data</span></a></li></ul></li><li><a class="tocitem" href="../Tutorial_Jura/">19 - Jura tutorial</a></li><li><a class="tocitem" href="../Tutorial_NumericalModel_2D/">20 - 2D model setups</a></li><li><a class="tocitem" href="../Tutorial_NumericalModel_3D/">21 - 3D model setups</a></li><li><a class="tocitem" href="../Tutorial_VolcanoModel_3D/">22 - 3D model setups</a></li><li><a class="tocitem" href="../tutorial_Polygon_structures/">23 - Build geometry from polygons</a></li></ul></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../datastructures/">Data Structures</a></li><li><a class="tocitem" href="../dataimport/">Data Import</a></li><li><a class="tocitem" href="../projection/">Projection</a></li><li><a class="tocitem" href="../asagi_io/">ASAGI</a></li><li><a class="tocitem" href="../paraview_output/">Paraview output</a></li><li><a class="tocitem" href="../paraview_collection/">Paraview collection</a></li><li><a class="tocitem" href="../surfaces/">Surfaces</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><a class="tocitem" href="../visualise/">Visualisation</a></li><li><a class="tocitem" href="../gravity_code/">Gravity code</a></li><li><a class="tocitem" href="../geodynamic_setups/">Numerical model setups</a></li><li><a class="tocitem" href="../lamem/">LaMEM</a></li><li><a class="tocitem" href="../ptatin/">pTatin</a></li><li><a class="tocitem" href="../Tutorial_Chmy_MPI/">Chmy</a></li><li><a class="tocitem" href="../profile_processing/">Profile Processing</a></li><li><a class="tocitem" href="../gmsh/">Gmsh</a></li><li><a class="tocitem" href="../movies/">Movies</a></li></ul></li><li><a class="tocitem" href="../listfunctions/">List of functions</a></li><li><a class="tocitem" href="../authors/">Authors</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>18 - Alpine data integration</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>18 - Alpine data integration</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/main/tutorials/Tutorial_AlpineData.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Alpine-Data-Visualization"><a class="docs-heading-anchor" href="#Alpine-Data-Visualization">Alpine Data Visualization</a><a id="Alpine-Data-Visualization-1"></a><a class="docs-heading-anchor-permalink" href="#Alpine-Data-Visualization" title="Permalink"></a></h1><h2 id="Goal"><a class="docs-heading-anchor" href="#Goal">Goal</a><a id="Goal-1"></a><a class="docs-heading-anchor-permalink" href="#Goal" title="Permalink"></a></h2><p>This is a tutorial to:</p><ol><li>Download datasets from known sources</li><li>Process and unify these datasets with <code>GeophysicalModelGenerator</code></li><li>Save the resulting dataset</li><li>Export the datasets to Paraview</li></ol><p>This is a rather lengthy tutorial that combines different other tutorials, but it will guide you through all the steps necessary to obtain a somewhat comprehensive view of the European Alps and their subsurface from a geodynamical point of view.</p><h2 id="1.-Surface-Topography"><a class="docs-heading-anchor" href="#1.-Surface-Topography">1. Surface Topography</a><a id="1.-Surface-Topography-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Surface-Topography" title="Permalink"></a></h2><p>In many cases, we want to add topographic data to our visualization. Here we use <a href="https://github.com/GenericMappingTools/GMT.jl">GMT.jl</a> to download data from a certain region, and transfer that to <code>GMG</code>. To add the GMT package, simply add it with the julia package manager:</p><pre><code class="language-julia hljs">julia&gt; ]
(@v1.10) pkg&gt; add GMT</code></pre><p>and load both <code>GMG</code> and <code>GMT</code> with:</p><pre><code class="language-julia hljs">using GeophysicalModelGenerator, GMT</code></pre><p>When loading both packages, several <code>GMT</code> routines within <code>GMG</code> will be loaded. One of these routines is the function <code>import_topo</code>, where one simply has to provide the region for which to download the topographic data and the data source.</p><pre><code class="language-julia hljs">Topo = import_topo([4,20,37,50], file=&quot;@earth_relief_01m&quot;)</code></pre><p>The data is available in different resolutions; see <a href="http://gmt.soest.hawaii.edu/doc/latest/grdimage.html">here</a> for an overview. Generally, it is advisable to not use the largest resolution if you have a large area, as the files become very large.</p><p>If you have issues with loading the topography with <code>GMT</code>, there is also the alternative to download the data yourself and import it using <code>Rasters.jl</code>.</p><p>We can now export this data to a <code>VTK</code> format so that we can visualize it with <code>Paraview</code>. To do so, <code>GMG</code> provides the function <code>write_paraview</code>:</p><pre><code class="language-julia hljs">write_paraview(Topo, &quot;Topography_Alps&quot;)</code></pre><p>Also, if you want to save this data for later use in julia, you can save it as <code>*.jld2</code> file using the function <code>save_GMG</code>:</p><pre><code class="language-julia hljs">save_GMG(&quot;Topography_Alps&quot;,Topo)</code></pre><p>The result looks like: <img src="../../assets/img/Tut_Alp_Image1.png" alt="Alps_Tutorial_1"/> Note that we used the <code>Oleron</code> scientific colormap from <a href="https://www.fabiocrameri.ch/colourmaps.php">here</a> for the topography.</p><h2 id="2.-Moho-topography"><a class="docs-heading-anchor" href="#2.-Moho-topography">2. Moho topography</a><a id="2.-Moho-topography-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Moho-topography" title="Permalink"></a></h2><p>When looking at data concerning the Alpine subsurface, we are often interested in the depth of the <a href="https://en.wikipedia.org/wiki/Mohorovi%C4%8Di%C4%87_discontinuity">Moho</a>.</p><h3 id="2.1-Download-and-import-of-the-data"><a class="docs-heading-anchor" href="#2.1-Download-and-import-of-the-data">2.1 Download and import of the data</a><a id="2.1-Download-and-import-of-the-data-1"></a><a class="docs-heading-anchor-permalink" href="#2.1-Download-and-import-of-the-data" title="Permalink"></a></h3><p>Here, we will use the dataset from Mroczek et al. (2023). This dataset is publicly available and can be downloaded from <a href="https://datapub.gfz-potsdam.de/download/10.5880.GFZ.2.4.2021.009NUEfb/2021-009_Mroczek-et-al_SWATHD_moho_jul22.csv">here</a>. To allow for downloading such data, we use the julia package <code>Downloads.jl</code>, which is a dependency of <code>GMG</code>. To download the Moho data in the current directory, simply type:</p><pre><code class="language-julia hljs">download_data(&quot;https://datapub.gfz-potsdam.de/download/10.5880.GFZ.2.4.2021.009NUEfb/2021-009_Mroczek-et-al_SWATHD_moho_jul22.csv&quot;,&quot;MohoMroczek2023.csv&quot;)</code></pre><p>Here the downloaded file gets the name <code>MohoMroczek2023.dat</code> and will be saved in the current directory. A quick look at the file shows that it contains a header consisting of 11 lines, one line with the description of the different columns and then the actual data. Have a look at the file yourself. To import the CSV file, we will use the package <a href="https://github.com/JuliaData/DelimitedFiles.jl">DelimitedFiles.jl</a>. Have a look at its documentation to see the different import options.</p><pre><code class="language-julia hljs">using DelimitedFiles
data_mroczek = readdlm(&quot;MohoMroczek2023.csv&quot;,&#39;,&#39;,header=false,skipstart=11)</code></pre><p>Note that we skipped the first 11 lines of the file as they contain the file header. The result of this operation will look like this:</p><pre><code class="language-julia hljs">julia&gt; data_mroczek = readdlm(&quot;MohoMroczek2023.csv&quot;,&#39;,&#39;,header=false,skipstart=11)
40786×10 Matrix{Any}:
     &quot;X&quot;      &quot;Y&quot;      &quot;Z&quot;    &quot;lat&quot;    &quot;lon&quot;    &quot;depth&quot;   &quot;tPs&quot;   &quot;k&quot;   &quot;interp&quot;  &quot;tag&quot;
 4185.26  1005.66  4640.51  47.152   13.5113  41.54      4.82    1.62  0          &quot;PA&quot;
 4186.9   1005.95  4639.04  47.1319  13.5099  41.4893    4.81    1.62  0          &quot;PA&quot;
 4188.54  1006.24  4637.57  47.1118  13.5085  41.4281    4.8     1.62  0          &quot;PA&quot;
 4190.2   1006.53  4636.11  47.0917  13.5072  41.3568    4.8     1.63  0          &quot;PA&quot;
 4191.86  1006.82  4634.66  47.0716  13.5058  41.2761    4.79    1.63  0          &quot;PA&quot;
 4193.51  1007.12  4633.22  47.0516  13.5045  41.1865    4.78    1.63  0          &quot;PA&quot;
 4195.18  1007.41  4631.78  47.0315  13.5031  41.0887    4.77    1.63  0          &quot;PA&quot;
 4196.85  1007.71  4630.34  47.0114  13.5018  40.9835    4.76    1.63  0          &quot;PA&quot;
 4198.53  1008.01  4628.91  46.9913  13.5004  40.8725    4.75    1.63  0          &quot;PA&quot;
 4183.59  1007.45  4642.47  47.1721  13.5396  40.92      4.75    1.62  0          &quot;PA&quot;
 4185.22  1007.73  4640.99  47.152   13.5382  40.8866    4.75    1.63  0          &quot;PA&quot;
 4186.85  1008.02  4639.51  47.1319  13.5368  40.8435    4.75    1.63  0          &quot;PA&quot;
 4188.49  1008.31  4638.04  47.1118  13.5355  40.7913    4.74    1.63  0          &quot;PA&quot;
 4190.14  1008.6   4636.57  47.0917  13.5341  40.7305    4.73    1.63  0          &quot;PA&quot;
    ⋮                                          ⋮
 4123.28  1111.52  4669.18  47.5537  15.0867  43.4301    5       1.67  0          &quot;EU&quot;
 4124.02  1111.57  4666.69  47.5336  15.0848  44.7763    5.13    1.67  0          &quot;EU&quot;
 4124.67  1111.59  4664.11  47.5136  15.0828  46.2535    5.28    1.67  0          &quot;EU&quot;
 4125.23  1111.59  4661.42  47.4935  15.0808  47.868     5.44    1.67  0          &quot;EU&quot;
 4125.71  1111.56  4658.63  47.4734  15.0788  49.6226    5.61    1.67  0          &quot;EU&quot;
 4126.09  1111.51  4655.74  47.4533  15.0768  51.5103    5.79    1.66  0          &quot;EU&quot;
 4126.41  1111.45  4652.77  47.4332  15.0749  53.496     6       1.66  0          &quot;EU&quot;
 4126.7   1111.38  4649.78  47.4131  15.0729  55.5207    6.21    1.66  0          &quot;EU&quot;
 4126.93  1111.28  4646.73  47.393   15.0709  57.6306    6.45    1.66  0          &quot;EU&quot;
 4127.05  1111.16  4643.54  47.3729  15.0689  59.9233    6.7     1.66  0          &quot;EU&quot;
 4127.0   1111.0   4640.2   47.3529  15.067   62.4358    6.98    1.66  1          &quot;EU&quot;
 4126.2   1113.34  4649.82  47.4131  15.1     55.4728    6.21    1.66  0          &quot;EU&quot;
 4126.41  1113.24  4646.74  47.393   15.098   57.6211    6.45    1.66  0          &quot;EU&quot;
 4126.5   1113.11  4643.52  47.3729  15.096   59.9569    6.71    1.66  0          &quot;EU&quot;</code></pre><p>We are now only interested in the depth of the Moho at a given longitude/latitude. To obtain these values, we now have to extract columns 4-6. In addition, we also extract the 10th column, as it contains an identifier for the tectonic unit the respective point belongs to.</p><pre><code class="language-julia hljs">lon        = zeros(size(data_mroczek,1)-1);     lon   .= data_mroczek[2:end,5];
lat        = zeros(size(data_mroczek,1)-1);     lat   .= data_mroczek[2:end,4];
depth      = zeros(size(data_mroczek,1)-1);     depth .= -1.0*data_mroczek[2:end,6]; #multiplied with -1, as we consider depth to be negative
tag        = string.(data_mroczek[2:end,10]); #get unit identifiers und convert them to strings
nothing #hide</code></pre><p>As a next step, we determine how many different tectonic units there are:</p><pre><code class="language-julia hljs">units = unique(tag) #get different units</code></pre><p>We will use these units later to save the Moho data separately for each tectonic unit.</p><h3 id="2.2-Converting-the-data-to-a-GMG-dataset"><a class="docs-heading-anchor" href="#2.2-Converting-the-data-to-a-GMG-dataset">2.2 Converting the data to a <code>GMG</code> dataset</a><a id="2.2-Converting-the-data-to-a-GMG-dataset-1"></a><a class="docs-heading-anchor-permalink" href="#2.2-Converting-the-data-to-a-GMG-dataset" title="Permalink"></a></h3><p>To convert this data to a <code>GMG</code> dataset, we now have to interpolate it to a regular grid. You can generate the respective grid with the <code>GMG</code> function <code>lonlatdepth_grid</code></p><pre><code class="language-julia hljs">Lon,Lat,Depth = lonlatdepth_grid(9.9:0.02:15.1,45.0:.02:49.0,0km);
nothing #hide</code></pre><p>To interpolate the Moho data of the different units to this grid, we have here decided to employ a simple Nearest Neighbor interpolation for simplicity.</p><pre><code class="language-julia hljs">using NearestNeighbors</code></pre><p>!!! note Interpolating data is tricky and may result in unnecessary smoothing of the data. There are different ways to interpolate data on a regular grid. Have a look at our data interpolation tutorial to see the different possibilities.</p><p>Now that we have generated the grid, we can loop over our different tectonic units, extract the relevant data points and interpolate them to the regular grid:</p><pre><code class="language-julia hljs">for iunit = 1:length(units)
    Dist              = zeros(size(Lon))

    #Get all points belonging to the unit
    ind_unit    = findall( x -&gt; occursin(units[iunit], x), tag) #index of the points belonging to that unit
    lon_tmp     = lon[ind_unit]
    lat_tmp     = lat[ind_unit]
    depth_tmp   = depth[ind_unit]

    #for later checking, we can now save the original point data as a VTK file:
    data_Moho = GeophysicalModelGenerator.GeoData(lon_tmp,lat_tmp,depth_tmp,(MohoDepth=depth_tmp*km,))
    filename = &quot;Mroczek_Moho_&quot; * units[iunit]
    write_paraview(data_Moho, filename, PointsData=true)

    #Now we create a KDTree for an effective nearest neighbor determination;
    kdtree = KDTree([lon_tmp&#39;;lat_tmp&#39;]; leafsize = 10)
    points = [Lon[:]&#39;;Lat[:]&#39;]
    idxs, dists = knn(kdtree, points, 1, true) #get the distance to the nearest data point
    dists = reduce(vcat,dists)
    idxs  = reduce(vcat,idxs)
    idxs  = reduce(vcat,idxs)

    #Having determined the nearest neighbor for each point in our regular grid, we can now directly assign the respective depth. Whenever the nearest neighbor is further than a certain distance away, we assume that there is no Moho at this point and do not assign a depth to that point.
    for i=1:length(idxs)
        if dists[i]&lt;0.02
            Depth[i] = depth_tmp[idxs[i]]*km
        else
            Depth[i] = NaN*km
        end
        Dist[i]  = dists[i]
    end

    #As we will be using the data later, we would also like to provide some Metadata so that we know where it is coming from:
    Data_attribs   = Dict(
        &quot;author&quot;=&gt;  &quot;Mroczek et al.&quot;,
        &quot;year&quot;=&gt; &quot;2023&quot;,
        &quot;doi&quot;=&gt;&quot;https://doi.org/10.5880/GFZ.2.4.2021.009&quot;,
        &quot;url&quot;=&gt;&quot;https://nextcloud.gfz-potsdam.de/s/zB5dPNby6X2Kjnj&quot;,
    )

    #Finally, we can now export that data to VTK and save a `jld2` file using the `save_GMG` routine
    Data_Moho = GeophysicalModelGenerator.GeoData(Lon, Lat, Depth, (MohoDepth=Depth,PointDist=Dist),Data_attribs)
    filename = &quot;Mrozek_Moho_Grid_&quot; * units[iunit]
    write_paraview(Data_Moho, filename)
    save_GMG(filename,Topo)

end</code></pre><p>Just for checking, we can also plot both the original data and the resulting interpolated Moho: <img src="../../assets/img/Tut_Alp_Image2.png" alt="Alps_Tutorial_2"/></p><h2 id="3.-Seismicity"><a class="docs-heading-anchor" href="#3.-Seismicity">3. Seismicity</a><a id="3.-Seismicity-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Seismicity" title="Permalink"></a></h2><p>Earthquakes are always interesting, so lets import the seismicity data from ISC.</p><h3 id="3.1-Download-and-import"><a class="docs-heading-anchor" href="#3.1-Download-and-import">3.1 Download and import</a><a id="3.1-Download-and-import-1"></a><a class="docs-heading-anchor-permalink" href="#3.1-Download-and-import" title="Permalink"></a></h3><p>ISC provides a method to download parts of it&#39;s catalogue via a web interface. See the description of the interface <a href="http://www.isc.ac.uk/iscbulletin/search/webservices/bulletin/">here</a>. We will now download all reviewed earthquake data between 1990 and 2015 in the same region as the extracted topography. We will only consider earthquakes with a magnitude larger than 3. The resulting dataset is quite large, so consider to either limit the time range or the magnitude range.</p><pre><code class="language-julia hljs">download_data(&quot;http://www.isc.ac.uk/cgi-bin/web-db-run?request=COLLECTED&amp;req_agcy=ISC-EHB&amp;out_format=QuakeML&amp;ctr_lat=&amp;ctr_lon=&amp;radius=&amp;max_dist_units=deg&amp;searchshape=RECT&amp;top_lat=49&amp;bot_lat=37&amp;left_lon=4&amp;right_lon=20&amp;srn=&amp;grn=&amp;start_year=1990&amp;start_month=1&amp;start_day=01&amp;start_time=00%3A00%3A00&amp;end_year=2015&amp;end_month=12&amp;end_day=31&amp;end_time=00%3A00%3A00&amp;min_dep=&amp;max_dep=&amp;min_mag=3.0&amp;max_mag=&amp;req_mag_type=Any&amp;req_mag_agcy=Any&amp;min_def=&amp;max_def=&amp;prime_only=on&amp;include_magnitudes=on&amp;table_owner=iscehb&quot;,&quot;ISCData.xml&quot;)</code></pre><p>Once the data has been downloaded, we can extract <code>lon/lat/depth/magnitude</code> using the <code>GMG</code> function <code>getlonlatdepthmag_QuakeML</code>, which returns a <code>GeoData</code> structure:</p><pre><code class="language-julia hljs">Data_ISC = getlonlatdepthmag_QuakeML(&quot;ISCData.xml&quot;);
nothing #hide</code></pre><p>As before, we can export this dataset to <code>VTK</code> and also save it as a <code>jld2</code> file (as we are now exporting point data, we have to use the option <code>PointsData=true</code>):</p><pre><code class="language-julia hljs">write_paraview(Data_ISC, &quot;EQ_ISC&quot;, PointsData=true);
save_GMG(&quot;EQ_ISC&quot;,Data_ISC)</code></pre><p><img src="../../assets/img/Tut_Alp_Image3.png" alt="Alps_Tutorial_3"/></p><h2 id="4.-GPS-data"><a class="docs-heading-anchor" href="#4.-GPS-data">4. GPS data</a><a id="4.-GPS-data-1"></a><a class="docs-heading-anchor-permalink" href="#4.-GPS-data" title="Permalink"></a></h2><p>Besides data on the structure of the subsurface, it is also nice to see the dynamics of a region. Dynamic processes can be nicely seen in the surface velocities given by GPS data. As GPS data consists of three-dimensional vectors, we have to treat it differently than the seismicity data in the previous section. The example is based on a paper by Sanchez et al. (2018) <a href="https://essd.copernicus.org/articles/10/1503/2018/#section7">https://essd.copernicus.org/articles/10/1503/2018/#section7</a>.</p><h3 id="4.1.-Download-and-import-GPS-data:"><a class="docs-heading-anchor" href="#4.1.-Download-and-import-GPS-data:">4.1. Download and import GPS data:</a><a id="4.1.-Download-and-import-GPS-data:-1"></a><a class="docs-heading-anchor-permalink" href="#4.1.-Download-and-import-GPS-data:" title="Permalink"></a></h3><p>The data related to the paper can be downloaded from: <a href="https://doi.pangaea.de/10.1594/PANGAEA.886889">here</a>. There you will find links to several data sets. Some are the data on the actual stations and some are interpolated data on a grid. Here, we will use the gridded data as an example, and will therefore download the following data sets:</p><ul><li>ALPS2017<em>DEF</em>HZ	Surface deformation model of the Alpine Region	<a href="https://store.pangaea.de/Publications/Sanchez-etal_2018/ALPS2017_DEF_HZ.GRD">https://store.pangaea.de/Publications/Sanchez-etal<em>2018/ALPS2017</em>DEF_HZ.GRD</a></li><li>ALPS2017<em>DEF</em>VT	Vertical deformation model of the Alpine Region	<a href="https://store.pangaea.de/Publications/Sanchez-etal_2018/ALPS2017_DEF_VT.GRD">https://store.pangaea.de/Publications/Sanchez-etal<em>2018/ALPS2017</em>DEF_VT.GRD</a></li></ul><pre><code class="language-julia hljs">download_data(&quot;https://store.pangaea.de/Publications/Sanchez-etal_2018/ALPS2017_DEF_HZ.GRD&quot;,&quot;ALPS2017_DEF_HZ.GRD&quot;)
download_data(&quot;https://store.pangaea.de/Publications/Sanchez-etal_2018/ALPS2017_DEF_VT.GRD&quot;,&quot;ALPS2017_DEF_VT.GRD&quot;)</code></pre><p>Next, we will load the data. As above, we will use <code>DelimitedFiles.jl</code> to load the data. Let&#39;s first start with the vertical velocities, which are stored in <code>ALPS2017_DEF_VT.GRD</code>. If we open that file with a text editor, we see that the data starts at line 18, and has the following format:</p><p>Column 1: Longitude [degrees] Column 2: Latitude [degrees] Column 3: Velocity in the height direction [m/a] Column 4: Uncertainty of the height component [m/a]</p><p>So we have 4 columns with data values, and the data is separated by spaces. We can load that in julia as:</p><pre><code class="language-julia hljs">data_vz = readdlm(&quot;ALPS2017_DEF_VT.GRD&quot;,header=false,skipstart=17)</code></pre><p>And extract the data as vectors:</p><pre><code class="language-julia hljs">lon_vz =   data_vz[:,1]
lat_vz =   data_vz[:,2]
vz     =   data_vz[:,3]</code></pre><p>To have a closer look at the data, let&#39;s plot it. To do so, we will employ the julia package <code>Plots.jl</code>.</p><pre><code class="language-julia hljs">using Plots
Plots.scatter(lon_vz,lat_vz)</code></pre><p>We can see that the data is distributed on a regular grid. We can determine the size of this grid with:</p><pre><code class="language-julia hljs">nlon = length(unique(lon_vz))
nlat = length(unique(lat_vz))</code></pre><p>So we have a <code>41</code> by <code>31</code> grid. GMG requires 3D matrixes for the data (as we want to plot the results in Paraview in 3D). That is why we first initialize 3D matrixes for <code>lon,lat,Vz</code>:</p><pre><code class="language-julia hljs">Lon   =   zeros(nlon,nlat,1)
Lat   =   zeros(nlon,nlat,1)
Vz    =   zeros(nlon,nlat,1)</code></pre><p>And we can reshape the vectors accordingly:</p><pre><code class="language-julia hljs">Lon[:,:,1] =   reshape(lon_vz,(nlon,nlat))
Lat[:,:,1] =   reshape(lat_vz,(nlon,nlat))
Vz[:,:,1]  =   reshape(vz,(nlon,nlat))</code></pre><p>Now that we have imported the vertical velocities, let&#39;s do the same for the horizontal ones. Again looking at the data, we see that it starts at line 19 and is organized as follows: <code>Column 1: Longitude [degrees]</code> <code>Column 2: Latitude [degrees]</code> <code>Column 3: East component of the deformation [m/a]</code> <code>Column 4: North component of the deformation [m/a]</code> <code>Column 5: Uncertainty of the east component [m/a]</code> <code>Column 6: Uncertainty of the north component [m/a]</code></p><p>Let&#39;s load the data again and extract the relevant data:</p><pre><code class="language-julia hljs">data_vh = readdlm(&quot;ALPS2017_DEF_HZ.GRD&quot;,header=false,skipstart=18)

lon_vh =   data_vh[:,1]
lat_vh =   data_vh[:,2]
ve     =   data_vh[:,3]
vn     =   data_vh[:,4]</code></pre><p>Let&#39;s have a look at how the data points of this dataset are distributed:</p><pre><code class="language-julia hljs">Plots.scatter(lon_vh,lat_vh)</code></pre><p>So it appears that the horizontal velocities are given on the same regular grid as well, but not in regions which are covered with water. This thus requires a bit more work to transfer them to a rectangular grid. The strategy we take is to first define 2D matrixes with horizontal velocities with the same size as <code>Vz</code> initialized with <code>NaN</code> (not a number).</p><pre><code class="language-julia hljs">Ve = fill(NaN,size(Vz));
Vn = fill(NaN,size(Vz));
nothing #hide</code></pre><p>Next, we loop over all points in <code>lon_Hz,lat_Hz</code> and place them into 2D matrixes:</p><pre><code class="language-julia hljs">for i in eachindex(lon_vh)
    ind = intersect(findall(x-&gt;x==lon_vh[i], Lon), findall(x-&gt;x==lat_vh[i], Lat))
    Ve[ind] .= ve[i];
    Vn[ind] .= vn[i];
end</code></pre><p>At this stage, we have horizontal and vertical velocities in units of <code>m/yr</code>. Yet, given the small velocities in the Alps, it makes more sense to have them in units of <code>mm/yr</code>:</p><pre><code class="language-julia hljs">Vz = Vz*1000;
Ve = Ve*1000;
Vn = Vn*1000;
nothing #hide</code></pre><p>And their magnitude is</p><pre><code class="language-julia hljs">Vmagnitude  =   sqrt.(Ve.^2 + Vn.^2 + Vz.^2);
nothing #hide</code></pre><h3 id="4.2-Interpolate-topography-on-the-grid"><a class="docs-heading-anchor" href="#4.2-Interpolate-topography-on-the-grid">4.2 Interpolate topography on the grid</a><a id="4.2-Interpolate-topography-on-the-grid-1"></a><a class="docs-heading-anchor-permalink" href="#4.2-Interpolate-topography-on-the-grid" title="Permalink"></a></h3><p>At this stage we have the 3D velocity components on a grid. Yet, we don&#39;t have information yet about the elevation of the stations (as the provided data set did not give this). We could ignore that and set the elevation to zero, which would allow saving the data directly. Yet, a better way is to load the topographic map of the area and interpolate the elevation to the velocity grid. As we have already the loaded the topographic map in section 1 of this tutorial, we can simply reuse it. To interpolate, we will use the function <code>interpolate_datafields_2D</code></p><pre><code class="language-julia hljs">topo_v, fields_v = interpolate_datafields_2D(Topo, Lon, Lat)</code></pre><p>The variable we are interested in is the variable <code>topo_v</code>. <code>fields_v</code> contains the interpolation of all the fields in <code>Topo</code> to the new grid and we only keep it here for completeness. Note that as the topography in the <code>Topo</code> variable is in km, <code>topo_v</code> will also be given the unit of km. Next, we have to combine the data in a GeoData structure. The velocities are specified as a <code>Tuple</code> (called <code>Velocity_mm_year</code>), which is interpreted a vector when saving this to <code>Paraview</code>.</p><pre><code class="language-julia hljs">Data_GPS_Sanchez = GeoData(Lon,Lat,topo_v,(Velocity_mm_year=(Ve,Vn,Vz),V_north=Vn*mm/yr, V_east=Ve*mm/yr, V_vertical=Vz*mm/yr, Vmagnitude = Vmagnitude*mm/yr, Topo=fields_v.Topography))</code></pre><p>And as always, we&#39;ll save everything in <code>VTK</code> format and in <code>jld2</code> format</p><pre><code class="language-julia hljs">write_paraview(Data_GPS_Sanchez, &quot;GPS_Sanchez&quot;)
save_GMG(&quot;GPS_Sanchez&quot;,Data_GPS_Sanchez)</code></pre><p><img src="../../assets/img/Tut_Alp_Image4.png" alt="Alps_Tutorial_4"/></p><h2 id="5.-Seismic-tomography-data"><a class="docs-heading-anchor" href="#5.-Seismic-tomography-data">5. Seismic tomography data</a><a id="5.-Seismic-tomography-data-1"></a><a class="docs-heading-anchor-permalink" href="#5.-Seismic-tomography-data" title="Permalink"></a></h2><p>Finally, we&#39;d like to have a look at the subsurface by looking at a seismic tomography. To do so, we&#39;ll first download the tomography published by <a href="https://doi.org/10.1029/2021JB023488">Rappisi et al.(2022)</a>. The data is provided as <code>NetCDF</code> files:</p><pre><code class="language-julia hljs">download_data(&quot;https://figshare.com/ndownloader/files/34093955&quot;,&quot;aniNEWTON21.nc&quot;)</code></pre><p>We can load this file with the <code>NCDatasets</code> package.</p><pre><code class="language-julia hljs">using NCDatasets
dataset = NCDataset(&quot;aniNEWTON21.nc&quot;,&quot;r&quot;)</code></pre><p>The output of this command will also provide you with an overview of the file content. In the following, we will extract some of this content.</p><pre><code class="language-julia hljs">lon     = dataset[&quot;Longitude&quot;]
lat     = dataset[&quot;Latitude&quot;]
dlnVp   = dataset[&quot;dlnVp&quot;]
Vp      = dataset[&quot;Vpi&quot;]
Depth   = dataset[&quot;Zg&quot;]</code></pre><p>As longitude and latitude are only given as 2D grids, we here have to convert them to 3D matrices.</p><pre><code class="language-julia hljs">Lon = repeat(lon[:,:],1,1,size(Depth,3));
Lat = repeat(lat[:,:],1,1,size(Depth,3));
nothing #hide</code></pre><p>Finally, as we would like to keep the information on the data source, we add this information as a dictionary.</p><pre><code class="language-julia hljs">Data_attribs   = Dict(
    &quot;author&quot;=&gt;  &quot;Rappisi, F. and VanderBeek, B. P. and Faccenda, M. and Morelli, A. and Molinari, I.&quot;,
    &quot;title&quot; =&gt; &quot;Slab Geometry and Upper Mantle Flow Patterns in the Central Mediterranean From 3D Anisotropic P-Wave Tomography&quot;,
    &quot;journal&quot;=&gt;&quot;Journal of Geophysical Research: Solid Earth&quot;,
    &quot;volume&quot;=&gt;127,
    &quot;number&quot;=&gt;5,
    &quot;pages&quot;=&gt;&quot;e2021JB023488&quot;,
    &quot;doi&quot;=&gt;&quot;https://doi.org/10.1029/2021JB023488&quot;,
    &quot;url&quot;=&gt;&quot;https://doi.org/10.1029/2021JB023488&quot;,
    &quot;year&quot;=&gt;2022
)</code></pre><p>Now we are all set and can create a GeoData structure which along with metadata</p><pre><code class="language-julia hljs">Data = GeoData(Lon,Lat,Depth[:,:,:],(Vp=Vp[:,:,:],dVp=dlnVp[:,:,:]),Data_attribs);
nothing #hide</code></pre><p>And then we save it again.</p><pre><code class="language-julia hljs">write_paraview(Data, &quot;Rappisi2022&quot;)
save_GMG(&quot;Rappisi2022&quot;,Data)</code></pre><p>The result looks like: <img src="../../assets/img/Tut_Alp_Image5.png" alt="Alps_Tutorial_5"/></p><p>For the sake of this tutorial, we have now imported all the data we would like to look at. All that is missing is now a joint visualization of these datasets. To obtain this visualization, we will load all the <code>VTK</code> files into Paraview and have a look: <img src="../../assets/img/GMG_AlpineData.png" alt="Alps_Tutorial_6"/></p><p>A Paraview statefile that reproduces this visualization is available under <code>tutorials/Tutorial_AlpineData.pvsm</code>.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Tutorial_FaultDensity/">« 17 - Fault Density Map</a><a class="docs-footer-nextpage" href="../Tutorial_Jura/">19 - Jura tutorial »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 30 January 2026 10:12">Friday 30 January 2026</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
