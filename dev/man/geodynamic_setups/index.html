<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Numerical model setups · GeophysicalModelGenerator.jl</title><meta name="title" content="Numerical model setups · GeophysicalModelGenerator.jl"/><meta property="og:title" content="Numerical model setups · GeophysicalModelGenerator.jl"/><meta property="twitter:title" content="Numerical model setups · GeophysicalModelGenerator.jl"/><meta name="description" content="Documentation for GeophysicalModelGenerator.jl."/><meta property="og:description" content="Documentation for GeophysicalModelGenerator.jl."/><meta property="twitter:description" content="Documentation for GeophysicalModelGenerator.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="GeophysicalModelGenerator.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeophysicalModelGenerator.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/">Overview</a></li><li><a class="tocitem" href="../Tutorial_Basic/">1 - Getting started</a></li><li><a class="tocitem" href="../tutorial_load3DSeismicData/">2 - 3D seismic tomography from ASCII</a></li><li><a class="tocitem" href="../tutorial_loadregular3DSeismicData_netCDF/">3 - 3D seismic tomography from netCDF</a></li><li><a class="tocitem" href="../Tutorial_MohoTopo_Spada/">4 - Visualize Moho topography</a></li><li><a class="tocitem" href="../tutorial_GMT_Topography/">5 - Create GMT-based topography</a></li><li><a class="tocitem" href="../tutorial_Coastlines/">6 - Coastlines</a></li><li><a class="tocitem" href="../tutorial_Screenshot_To_Paraview/">7 - Import screenshots</a></li><li><a class="tocitem" href="../tutorial_loadirregular3DSeismicData/">8 - Interpolate irregular 3D seismic tomography</a></li><li><a class="tocitem" href="../tutorial_GMT_Topography_GeologicalMap/">9 - ETOPO1 Topography and geological maps</a></li><li><a class="tocitem" href="../tutorial_ISC_data/">10 - ISC earthquake data</a></li><li><a class="tocitem" href="../tutorial_GPS/">11 - Plot GPS vectors</a></li><li><a class="tocitem" href="../tutorial_UTM/">12 - Read UTM data</a></li><li><a class="tocitem" href="../Tutorial_Votemaps/">13 - VoteMaps</a></li><li><a class="tocitem" href="../tutorial_local_Flegrei/">14 - Campi Flegrei</a></li><li><a class="tocitem" href="../Tutorial_LaPalma/">15 - La Palma volcano Model</a></li><li><a class="tocitem" href="../tutorial_time_Seismicity/">16 - Create movies</a></li><li><a class="tocitem" href="../Tutorial_FaultDensity/">17 - Fault Density Map</a></li><li><a class="tocitem" href="../Tutorial_AlpineData/">18 - Alpine data integration</a></li><li><a class="tocitem" href="../Tutorial_Jura/">19 - Jura tutorial</a></li><li><a class="tocitem" href="../Tutorial_NumericalModel_2D/">20 - 2D model setups</a></li><li><a class="tocitem" href="../Tutorial_NumericalModel_3D/">21 - 3D model setups</a></li><li><a class="tocitem" href="../Tutorial_VolcanoModel_3D/">22 - 3D model setups</a></li><li><a class="tocitem" href="../tutorial_Polygon_structures/">23 - Build geometry from polygons</a></li></ul></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../datastructures/">Data Structures</a></li><li><a class="tocitem" href="../dataimport/">Data Import</a></li><li><a class="tocitem" href="../projection/">Projection</a></li><li><a class="tocitem" href="../asagi_io/">ASAGI</a></li><li><a class="tocitem" href="../paraview_output/">Paraview output</a></li><li><a class="tocitem" href="../paraview_collection/">Paraview collection</a></li><li><a class="tocitem" href="../surfaces/">Surfaces</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><a class="tocitem" href="../visualise/">Visualisation</a></li><li><a class="tocitem" href="../gravity_code/">Gravity code</a></li><li class="is-active"><a class="tocitem" href>Numerical model setups</a></li><li><a class="tocitem" href="../lamem/">LaMEM</a></li><li><a class="tocitem" href="../ptatin/">pTatin</a></li><li><a class="tocitem" href="../Tutorial_Chmy_MPI/">Chmy</a></li><li><a class="tocitem" href="../profile_processing/">Profile Processing</a></li><li><a class="tocitem" href="../gmsh/">Gmsh</a></li><li><a class="tocitem" href="../movies/">Movies</a></li></ul></li><li><a class="tocitem" href="../listfunctions/">List of functions</a></li><li><a class="tocitem" href="../authors/">Authors</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li class="is-active"><a href>Numerical model setups</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Numerical model setups</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/main/docs/src/man/geodynamic_setups.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Numerical-model-setups"><a class="docs-heading-anchor" href="#Numerical-model-setups">Numerical model setups</a><a id="Numerical-model-setups-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-model-setups" title="Permalink"></a></h1><p>In order to generate numerical simulations from setups created with <code>GeophysicalModelGenerator.jl</code>, we provide a few routines that directly create setups. </p><p>The routines provided here have the following functionality:</p><ul><li>Add lithospheric boxes to a setup, that may have a layered structure and various thermal structures</li><li>Add various geometries (spheres, cuylinders, ellipsoids)</li><li>Add lithospheric structure</li><li>Add various 1D thermal structures (and possibilities to combine them)</li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.add_box!" href="#GeophysicalModelGenerator.add_box!"><code>GeophysicalModelGenerator.add_box!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_box!(Phase, Temp, Grid::AbstractGeneralGrid; xlim::Tuple = (20,100), [ylim::Tuple = (1,10)], zlim::Tuple = (10,80),
        Origin=nothing, StrikeAngle=0, DipAngle=0,
        phase = ConstantPhase(1),
        T=nothing,
        segments=nothing,
        cell=false )</code></pre><p>Adds a box with phase &amp; temperature structure to a 3D model setup.  This simplifies creating model geometries in geodynamic models</p><p><strong>Parameters</strong></p><ul><li><code>Phase</code> - Phase array (consistent with Grid)</li><li><code>Temp</code>  - Temperature array (consistent with Grid)</li><li><code>Grid</code> -  grid structure (can be any of the grid types in <code>GMG</code>)</li><li><code>xlim</code> -  left/right coordinates of box</li><li><code>ylim</code> -  front/back coordinates of box [optional; if not specified we use the whole box]</li><li><code>zlim</code> -  bottom/top coordinates of box</li><li><code>Origin</code> - the origin, used to rotate the box around. Default is the left-front-top corner</li><li><code>StrikeAngle</code> - strike angle of slab</li><li><code>DipAngle</code> - dip angle of slab</li><li><code>phase</code> - specifies the phase of the box. See <code>ConstantPhase()</code>,<code>LithosphericPhases()</code></li><li><code>T</code> - specifies the temperature of the box. See <code>ConstantTemp()</code>,<code>LinearTemp()</code>,<code>HalfspaceCoolingTemp()</code>,<code>SpreadingRateTemp()</code>,<code>LithosphericTemp()</code></li><li><code>segments</code> - optional parameter to define multiple ridge segments within the box</li><li><code>cell</code> - if true, <code>Phase</code> and <code>Temp</code> are defined on centers</li></ul><p><strong>Examples</strong></p><p>Example 1) Box with constant phase and temperature &amp; a dip angle of 10 degrees:</p><pre><code class="language-julia-repl hljs">julia&gt; Grid = read_LaMEM_inputfile(&quot;test_files/SaltModels.dat&quot;)
LaMEM Grid:
  nel         : (32, 32, 32)
  marker/cell : (3, 3, 3)
  markers     : (96, 96, 96)
  x           ϵ [-3.0 : 3.0]
  y           ϵ [-2.0 : 2.0]
  z           ϵ [-2.0 : 0.0]
julia&gt; Phases = zeros(Int32,   size(Grid.X));
julia&gt; Temp   = zeros(Float64, size(Grid.X));
julia&gt; add_box!(Phases,Temp,Grid, xlim=(0,500), zlim=(-50,0), phase=ConstantPhase(3), DipAngle=10, T=ConstantTemp(1000))
julia&gt; Model3D = ParaviewData(Grid, (Phases=Phases,Temp=Temp)); # Create Cartesian model
julia&gt; write_paraview(Model3D,&quot;LaMEM_ModelSetup&quot;)           # Save model to paraview
1-element Vector{String}:
 &quot;LaMEM_ModelSetup.vts&quot;</code></pre><p>Example 2) Box with halfspace cooling profile</p><pre><code class="language-julia-repl hljs">julia&gt; Grid = CartData(xyz_grid(-1000:10:1000,0,-660:10:0))
julia&gt; Phases = zeros(Int32,   size(Grid));
julia&gt; Temp   = zeros(Float64, size(Grid));
julia&gt; add_box!(Phases,Temp,Grid, xlim=(0,500), zlim=(-50,0), phase=ConstantPhase(3), DipAngle=10, T=HalfspaceCoolingTemp(Age=30))
julia&gt; Grid = addfield(Grid, (;Phases,Temp));       # Add to Cartesian model
julia&gt; write_paraview(Grid,&quot;LaMEM_ModelSetup&quot;)  # Save model to paraview
1-element Vector{String}:
 &quot;LaMEM_ModelSetup.vts&quot;</code></pre><p>Example 3) Box with ridge thermal structure ```julia-repl julia&gt; Grid = CartData(xyz<em>grid(-1000:10:1000, -1000:10:1000, -660:5:0)) julia&gt; Phases = fill(2, size(Grid)); julia&gt; Temp   = fill(1350.0, size(Grid)); julia&gt; segments = [((-500.0, -1000.0), (-500.0, 0.0)),                     ((-250.0, 0.0), (-250.0, 200.0)),                     ((-750.0, 200.0), (-750.0, 1000.0))]; julia&gt; lith = LithosphericPhases(Layers=[15 55], Phases=[1 2], Tlab=1250); julia&gt; add</em>box!(Phases, Temp, Grid; xlim=(-1000.0, 0.0), ylim=(-500.0, 500.0),                 zlim=(-80.0, 0.0), phase=lith,                 T=SpreadingRateTemp(SpreadingVel=3), segments=segments) julia&gt; Grid = addfield(Grid, (; Phases, Temp));       # Add to Cartesian model julia&gt; write<em>paraview(Grid, &quot;Ridge</em>Thermal<em>Structure&quot;)  # Save model to Paraview 1-element Vector{String}:  &quot;Ridge</em>Thermal_Structure.vts&quot;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/a5b0188fa123523dd7c3e6c8c804087565d8f96b/src/Setup_geometry.jl#L168-L245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.add_layer!" href="#GeophysicalModelGenerator.add_layer!"><code>GeophysicalModelGenerator.add_layer!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_layer!(Phase, Temp, Grid::AbstractGeneralGrid; xlim::Tuple = (1,100), [ylim::Tuple = (0,20)], zlim::Tuple = (0,-100),
        phase = ConstantPhase(1),
        T=nothing, cell=false )</code></pre><p>Adds a layer with phase &amp; temperature structure to a 3D model setup. The most common use would be to add a lithospheric layer to a model setup. This simplifies creating model geometries in geodynamic models</p><p><strong>Parameters</strong></p><ul><li><code>Phase</code> - Phase array (consistent with Grid)</li><li><code>Temp</code>  - Temperature array (consistent with Grid)</li><li><code>Grid</code> -  grid structure (usually obtained with read<em>LaMEM</em>inputfile, but can also be other grid types)</li><li><code>xlim</code> -  left/right coordinates of box</li><li><code>ylim</code> -  front/back coordinates of box</li><li><code>zlim</code> -  bottom/top coordinates of box</li><li><code>phase</code> - specifies the phase of the box. See <code>ConstantPhase()</code>,<code>LithosphericPhases()</code></li><li><code>T</code> - specifies the temperature of the box. See <code>ConstantTemp()</code>,<code>LinearTemp()</code>,<code>HalfspaceCoolingTemp()</code>,<code>SpreadingRateTemp()</code></li></ul><p><strong>Examples</strong></p><p>Example 1) Layer with constant phase and temperature</p><pre><code class="language-julia-repl hljs">julia&gt; Grid = read_LaMEM_inputfile(&quot;test_files/SaltModels.dat&quot;)
LaMEM Grid:
  nel         : (32, 32, 32)
  marker/cell : (3, 3, 3)
  markers     : (96, 96, 96)
  x           ϵ [-3.0 : 3.0]
  y           ϵ [-2.0 : 2.0]
  z           ϵ [-2.0 : 0.0]
julia&gt; Phases = zeros(Int32,   size(Grid.X));
julia&gt; Temp   = zeros(Float64, size(Grid.X));
julia&gt; add_layer!(Phases,Temp,Grid, zlim=(-50,0), phase=ConstantPhase(3), T=ConstantTemp(1000))
julia&gt; Model3D = ParaviewData(Grid, (Phases=Phases,Temp=Temp)); # Create Cartesian model
julia&gt; write_paraview(Model3D,&quot;LaMEM_ModelSetup&quot;)           # Save model to paraview
1-element Vector{String}:
 &quot;LaMEM_ModelSetup.vts&quot;</code></pre><p>Example 2) Box with halfspace cooling profile</p><pre><code class="language-julia-repl hljs">julia&gt; Grid = read_LaMEM_inputfile(&quot;test_files/SaltModels.dat&quot;)
julia&gt; Phases = zeros(Int32,   size(Grid.X));
julia&gt; Temp   = zeros(Float64, size(Grid.X));
julia&gt; add_layer!(Phases,Temp,Grid, zlim=(-50,0), phase=ConstantPhase(3), T=HalfspaceCoolingTemp())
julia&gt; Model3D = ParaviewData(Grid, (Phases=Phases,Temp=Temp)); # Create Cartesian model
julia&gt; write_paraview(Model3D,&quot;LaMEM_ModelSetup&quot;)           # Save model to paraview
1-element Vector{String}:
 &quot;LaMEM_ModelSetup.vts&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/a5b0188fa123523dd7c3e6c8c804087565d8f96b/src/Setup_geometry.jl#L316-L371">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.add_sphere!" href="#GeophysicalModelGenerator.add_sphere!"><code>GeophysicalModelGenerator.add_sphere!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_sphere!(Phase, Temp, Grid::AbstractGeneralGrid; cen::Tuple = (0,0,-1), radius::Number,
        phase = ConstantPhase(1).
        T=nothing, cell=false )</code></pre><p>Adds a sphere with phase &amp; temperature structure to a 3D model setup.  This simplifies creating model geometries in geodynamic models</p><p><strong>Parameters</strong></p><ul><li><code>Phase</code> - Phase array (consistent with Grid)</li><li><code>Temp</code>  - Temperature array (consistent with Grid)</li><li><code>Grid</code> - LaMEM grid structure (usually obtained with read<em>LaMEM</em>inputfile)</li><li><code>cen</code> - center coordinates of sphere</li><li><code>radius</code> - radius of sphere</li><li><code>phase</code> - specifies the phase of the box. See <code>ConstantPhase()</code>,<code>LithosphericPhases()</code></li><li><code>T</code> - specifies the temperature of the box. See <code>ConstantTemp()</code>,<code>LinearTemp()</code>,<code>HalfspaceCoolingTemp()</code>,<code>SpreadingRateTemp()</code></li><li><code>cell</code> - if true, <code>Phase</code> and <code>Temp</code> are defined on cell centers</li></ul><p><strong>Example</strong></p><p>Sphere with constant phase and temperature:</p><pre><code class="language-julia-repl hljs">julia&gt; Grid = read_LaMEM_inputfile(&quot;test_files/SaltModels.dat&quot;)
LaMEM Grid:
  nel         : (32, 32, 32)
  marker/cell : (3, 3, 3)
  markers     : (96, 96, 96)
  x           ϵ [-3.0 : 3.0]
  y           ϵ [-2.0 : 2.0]
  z           ϵ [-2.0 : 0.0]
julia&gt; Phases = zeros(Int32,   size(Grid.X));
julia&gt; Temp   = zeros(Float64, size(Grid.X));
julia&gt; add_sphere!(Phases,Temp,Grid, cen=(0,0,-1), radius=0.5, phase=ConstantPhase(2), T=ConstantTemp(800))
julia&gt; Model3D = ParaviewData(Grid, (Phases=Phases,Temp=Temp)); # Create Cartesian model
julia&gt; write_paraview(Model3D,&quot;LaMEM_ModelSetup&quot;)           # Save model to paraview
1-element Vector{String}:
 &quot;LaMEM_ModelSetup.vts&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/a5b0188fa123523dd7c3e6c8c804087565d8f96b/src/Setup_geometry.jl#L421-L463">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.add_ellipsoid!" href="#GeophysicalModelGenerator.add_ellipsoid!"><code>GeophysicalModelGenerator.add_ellipsoid!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_ellipsoid!(Phase, Temp, Grid::AbstractGeneralGrid; cen::Tuple = (-1,-1,-1), axes::Tuple = (0.2,0.1,0.5),
        Origin=nothing, StrikeAngle=0, DipAngle=0,
        phase = ConstantPhase(1).
        T=nothing, cell=false )</code></pre><p>Adds an Ellipsoid with phase &amp; temperature structure to a 3D model setup.  This simplifies creating model geometries in geodynamic models</p><p><strong>Parameters</strong></p><ul><li><code>Phase</code> - Phase array (consistent with Grid)</li><li><code>Temp</code>  - Temperature array (consistent with Grid)</li><li><code>Grid</code> - LaMEM grid structure (usually obtained with read<em>LaMEM</em>inputfile)</li><li><code>cen</code> - center coordinates of sphere</li><li><code>axes</code> - semi-axes of ellipsoid in X,Y,Z</li><li><code>Origin</code> - the origin, used to rotate the box around. Default is the left-front-top corner</li><li><code>StrikeAngle</code> - strike angle of slab</li><li><code>DipAngle</code> - dip angle of slab</li><li><code>phase</code> - specifies the phase of the box. See <code>ConstantPhase()</code>,<code>LithosphericPhases()</code></li><li><code>T</code> - specifies the temperature of the box. See <code>ConstantTemp()</code>,<code>LinearTemp()</code>,<code>HalfspaceCoolingTemp()</code>,<code>SpreadingRateTemp()</code></li><li><code>cell</code> - if true, <code>Phase</code> and <code>Temp</code> are defined on cell centers</li></ul><p><strong>Example</strong></p><p>Ellipsoid with constant phase and temperature, rotated 90 degrees and tilted by 45 degrees:</p><pre><code class="language-julia-repl hljs">julia&gt; Grid = read_LaMEM_inputfile(&quot;test_files/SaltModels.dat&quot;)
LaMEM Grid:
  nel         : (32, 32, 32)
  marker/cell : (3, 3, 3)
  markers     : (96, 96, 96)
  x           ϵ [-3.0 : 3.0]
  y           ϵ [-2.0 : 2.0]
  z           ϵ [-2.0 : 0.0]
julia&gt; Phases = zeros(Int32,   size(Grid.X));
julia&gt; Temp   = zeros(Float64, size(Grid.X));
julia&gt; add_ellipsoid!(Phases,Temp,Grid, cen=(-1,-1,-1), axes=(0.2,0.1,0.5), StrikeAngle=90, DipAngle=45, phase=ConstantPhase(3), T=ConstantTemp(600))
julia&gt; Model3D = ParaviewData(Grid, (Phases=Phases,Temp=Temp)); # Create Cartesian model
julia&gt; write_paraview(Model3D,&quot;LaMEM_ModelSetup&quot;)           # Save model to paraview
1-element Vector{String}:
 &quot;LaMEM_ModelSetup.vts&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/a5b0188fa123523dd7c3e6c8c804087565d8f96b/src/Setup_geometry.jl#L492-L536">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.add_cylinder!" href="#GeophysicalModelGenerator.add_cylinder!"><code>GeophysicalModelGenerator.add_cylinder!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_cylinder!(Phase, Temp, Grid::AbstractGeneralGrid; base::Tuple = (-1,-1,-1.5), cap::Tuple = (-1,-1,-0.5), radius::Number,
        phase = ConstantPhase(1),
        T=nothing, cell=false )</code></pre><p>Adds a cylinder with phase &amp; temperature structure to a 3D model setup.  This simplifies creating model geometries in geodynamic models</p><p><strong>Parameters</strong></p><ul><li><code>Phase</code> - Phase array (consistent with Grid)</li><li><code>Temp</code>  - Temperature array (consistent with Grid)</li><li><code>Grid</code> - Grid structure (usually obtained with <code>read_LaMEM_inputfile</code>)</li><li><code>base</code> - center coordinate of bottom of cylinder</li><li><code>cap</code> - center coordinate of top of cylinder</li><li><code>radius</code> - radius of the cylinder</li><li><code>phase</code> - specifies the phase of the box. See <code>ConstantPhase()</code>,<code>LithosphericPhases()</code></li><li><code>T</code> - specifies the temperature of the box. See <code>ConstantTemp()</code>,<code>LinearTemp()</code>,<code>HalfspaceCoolingTemp()</code>,<code>SpreadingRateTemp()</code></li><li><code>cell</code> - if true, <code>Phase</code> and <code>Temp</code> are defined on cell centers</li></ul><p><strong>Example</strong></p><p>Cylinder with constant phase and temperature:</p><pre><code class="language-julia-repl hljs">julia&gt; Grid = read_LaMEM_inputfile(&quot;test_files/SaltModels.dat&quot;)
LaMEM Grid:
  nel         : (32, 32, 32)
  marker/cell : (3, 3, 3)
  markers     : (96, 96, 96)
  x           ϵ [-3.0 : 3.0]
  y           ϵ [-2.0 : 2.0]
  z           ϵ [-2.0 : 0.0]
julia&gt; Phases = zeros(Int32,   size(Grid.X));
julia&gt; Temp   = zeros(Float64, size(Grid.X));
julia&gt; add_cylinder!(Phases,Temp,Grid, base=(-1,-1,-1.5), cap=(1,1,-0.5), radius=0.25, phase=ConstantPhase(4), T=ConstantTemp(400))
julia&gt; Model3D = ParaviewData(Grid, (Phases=Phases,Temp=Temp)); # Create Cartesian model
julia&gt; write_paraview(Model3D,&quot;LaMEM_ModelSetup&quot;)           # Save model to paraview
1-element Vector{String}:
 &quot;LaMEM_ModelSetup.vts&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/a5b0188fa123523dd7c3e6c8c804087565d8f96b/src/Setup_geometry.jl#L586-L629">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.add_stripes!" href="#GeophysicalModelGenerator.add_stripes!"><code>GeophysicalModelGenerator.add_stripes!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_stripes!(Phase, Grid::AbstractGeneralGrid;
    stripAxes       = (1,1,0),
    stripeWidth     =  0.2,
    stripeSpacing   =  1,
    Origin          =  nothing,
    StrikeAngle     =  0,
    DipAngle        =  10,
    phase           =  ConstantPhase(3),
    stripePhase     =  ConstantPhase(4),
    cell            = false)</code></pre><p>Adds stripes to a pre-defined phase (e.g. added using add_box!)</p><p><strong>Parameters</strong></p><ul><li><code>Phase</code> - Phase array (consistent with Grid)</li><li><code>Grid</code> -  grid structure (usually obtained with read<em>LaMEM</em>inputfile, but can also be other grid types)</li><li><code>stripAxes</code> - sets the axis for which we want the stripes. Default is (1,1,0) i.e. X, Y and not Z</li><li><code>stripeWidth</code> - width of the stripe</li><li><code>stripeSpacing</code> - space between two stripes</li><li><code>Origin</code> - the origin, used to rotate the box around. Default is the left-front-top corner</li><li><code>StrikeAngle</code> - strike angle</li><li><code>DipAngle</code> - dip angle</li><li><code>phase</code> - specifies the phase we want to apply stripes to</li><li><code>stripePhase</code> - specifies the stripe phase</li><li><code>cell</code> - if true, <code>Phase</code> and <code>Temp</code> are defined on centers</li></ul><p><strong>Example</strong></p><p>Example: Box with striped phase and constant temperature &amp; a dip angle of 10 degrees:</p><pre><code class="language-julia-repl hljs">julia&gt; Grid = read_LaMEM_inputfile(&quot;test_files/SaltModels.dat&quot;)
LaMEM Grid:
  nel         : (32, 32, 32)
  marker/cell : (3, 3, 3)
  markers     : (96, 96, 96)
  x           ϵ [-3.0 : 3.0]
  y           ϵ [-2.0 : 2.0]
  z           ϵ [-2.0 : 0.0]
julia&gt; Phases = zeros(Int32,   size(Grid.X));
julia&gt; Temp   = zeros(Float64, size(Grid.X));
julia&gt; add_box!(Phases,Temp,Grid, xlim=(0,500), zlim=(-50,0), phase=ConstantPhase(3), DipAngle=10, T=ConstantTemp(1000))
julia&gt; add_stripes!(Phases, Grid, stripAxes=(1,1,1), stripeWidth=0.2, stripeSpacing=1, Origin=nothing, StrikeAngle=0, DipAngle=10, phase=ConstantPhase(3), stripePhase=ConstantPhase(4))
julia&gt; Model3D = ParaviewData(Grid, (Phases=Phases,Temp=Temp)); # Create Cartesian model
julia&gt; write_paraview(Model3D,&quot;LaMEM_ModelSetup&quot;)           # Save model to paraview
1-element Vector{String}:
 &quot;LaMEM_ModelSetup.vts&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/a5b0188fa123523dd7c3e6c8c804087565d8f96b/src/Setup_geometry.jl#L58-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.add_slab!" href="#GeophysicalModelGenerator.add_slab!"><code>GeophysicalModelGenerator.add_slab!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_slab!(Phase, Temp, Grid::AbstractGeneralGrid,  trench::Trench; phase = ConstantPhase(1), T = nothing, cell=false)</code></pre><p>Adds a curved slab with phase &amp; temperature structure to a 3D model setup.</p><p><strong>Parameters</strong></p><ul><li><code>Phase</code>   - Phase array (consistent with Grid)</li><li><code>Temp</code>    - Temperature array (consistent with Grid)</li><li><code>Grid</code>    - grid structure (can be any of the grid types in <code>GMG</code>)</li><li><code>trench</code>  - Trench structure</li><li><code>phase</code>   - specifies the phase of the box. See <code>ConstantPhase()</code>,<code>LithosphericPhases()</code></li><li><code>T</code>       - specifies the temperature of the box. See <code>ConstantTemp()</code>,<code>LinearTemp()</code>,<code>HalfspaceCoolingTemp()</code>,<code>SpreadingRateTemp()</code>,<code>LithosphericTemp()</code></li><li><code>cell</code>    - if true, <code>Phase</code> and <code>Temp</code> are defined on cells</li></ul><p><strong>Examples</strong></p><p>Example 1) Slab</p><pre><code class="language-julia-repl hljs">julia&gt; x     = LinRange(0.0,1200.0,128);
julia&gt; y     = LinRange(0.0,1200.0,128);
julia&gt; z     = LinRange(-660,50,128);
julia&gt; Cart  = CartData(xyz_grid(x, y, z));
julia&gt; Phase = ones(Int64,size(Cart));
julia&gt; Temp  = fill(1350.0,size(Cart));
# Define the trench:
julia&gt; trench= Trench(Start = (400.0,400.0), End = (800.0,800.0), θ_max = 45.0, direction = 1.0, n_seg = 50, Length = 600.0, Thickness = 80.0, Lb = 500.0, d_decoupling = 100.0, type_bending =:Ribe)
julia&gt; phase = LithosphericPhases(Layers=[5 7 88], Phases = [2 3 4], Tlab=nothing)
julia&gt; TsHC  = HalfspaceCoolingTemp(Tsurface=20.0, Tmantle=1350, Age=30, Adiabat=0.4)
julia&gt; add_slab!(Phase, Temp, Cart, trench, phase = phase, T = TsHC)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/a5b0188fa123523dd7c3e6c8c804087565d8f96b/src/Setup_geometry.jl#L2119-L2152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.make_volc_topo" href="#GeophysicalModelGenerator.make_volc_topo"><code>GeophysicalModelGenerator.make_volc_topo</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>make<em>volc</em>topo(Grid::LaMEM_grid; center::Array{Float64, 1}, height::Float64, radius::Float64, crater::Float64,             base=0.0m, background=nothing)</p><p>Creates a generic volcano topography (cones and truncated cones)</p><p><strong>Parameters</strong></p><ul><li>Grid - LaMEM grid (created by read<em>LaMEM</em>inputfile)</li><li>center - x- and -coordinates of center of volcano</li><li>height - height of volcano</li><li>radius - radius of volcano</li></ul><p><strong>Optional Parameters</strong></p><ul><li>crater - this will create a truncated cone and the option defines the radius of the flat top</li><li>base - this sets the flat topography around the volcano</li><li>background - this allows loading in a topography and only adding the volcano on top (also allows stacking of several cones to get a volcano with different slopes)</li></ul><p><strong>Example</strong></p><p>Cylinder with constant phase and temperature:</p><pre><code class="language-julia-repl hljs">julia&gt; Grid = read_LaMEM_inputfile(&quot;test_files/SaltModels.dat&quot;)
LaMEM Grid:
  nel         : (32, 32, 32)
  marker/cell : (3, 3, 3)
  markers     : (96, 96, 96)
  x           ϵ [-3.0 : 3.0]
  y           ϵ [-2.0 : 2.0]
  z           ϵ [-2.0 : 0.0]
julia&gt; Topo = make_volc_topo(Grid, center=[0.0,0.0], height=0.4, radius=1.5, crater=0.5, base=0.1)
CartData
    size    : (33, 33, 1)
    x       ϵ [ -3.0 : 3.0]
    y       ϵ [ -2.0 : 2.0]
    z       ϵ [ 0.1 : 0.4]
    fields  : (:Topography,)
  attributes: [&quot;note&quot;]
julia&gt; Topo = make_volc_topo(Grid, center=[0.0,0.0], height=0.8, radius=0.5, crater=0.0, base=0.4, background=Topo.fields.Topography)
CartData
    size    : (33, 33, 1)
    x       ϵ [ -3.0 : 3.0]
    y       ϵ [ -2.0 : 2.0]
    z       ϵ [ 0.1 : 0.8]
    fields  : (:Topography,)
  attributes: [&quot;note&quot;]
julia&gt; write_paraview(Topo,&quot;VolcanoTopo&quot;)           # Save topography to paraview
Saved file: VolcanoTopo.vts</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/a5b0188fa123523dd7c3e6c8c804087565d8f96b/src/Setup_geometry.jl#L963-L1016">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.ConstantTemp" href="#GeophysicalModelGenerator.ConstantTemp"><code>GeophysicalModelGenerator.ConstantTemp</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ConstantTemp(T=1000)</code></pre><p>Sets a constant temperature inside the box</p><p><strong>Parameters</strong></p><ul><li>T : the value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/a5b0188fa123523dd7c3e6c8c804087565d8f96b/src/Setup_geometry.jl#L1135-L1143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.LinearTemp" href="#GeophysicalModelGenerator.LinearTemp"><code>GeophysicalModelGenerator.LinearTemp</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LinearTemp(Ttop=0, Tbot=1000)</code></pre><p>Set a linear temperature structure from top to bottom</p><p><strong>Parameters</strong></p><ul><li>Ttop : the value @ the top</li><li>Tbot : the value @ the bottom</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/a5b0188fa123523dd7c3e6c8c804087565d8f96b/src/Setup_geometry.jl#L1154-L1164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.HalfspaceCoolingTemp" href="#GeophysicalModelGenerator.HalfspaceCoolingTemp"><code>GeophysicalModelGenerator.HalfspaceCoolingTemp</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HalfspaceCoolingTemp(Tsurface=0, Tmantle=1350, Age=60, Adiabat=0)</code></pre><p>Sets a halfspace temperature structure in plate</p><p><strong>Parameters</strong></p><ul><li>Tsurface : surface temperature [C]</li><li>Tmantle : mantle temperature [C]</li><li>Age : Thermal Age of plate [Myrs]</li><li>Adiabat : Mantle Adiabat [K/km]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/a5b0188fa123523dd7c3e6c8c804087565d8f96b/src/Setup_geometry.jl#L1180-L1192">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.SpreadingRateTemp" href="#GeophysicalModelGenerator.SpreadingRateTemp"><code>GeophysicalModelGenerator.SpreadingRateTemp</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SpreadingRateTemp(Tsurface=0, Tmantle=1350, Adiabat=0, MORside=&quot;left&quot;,SpreadingVel=3, AgeRidge=0, maxAge=80)</code></pre><p>Sets a halfspace temperature structure within the box, combined with a spreading rate (which implies that the plate age varies)</p><p><strong>Parameters</strong></p><ul><li>Tsurface : surface temperature [C]</li><li>Tmantle : mantle temperature [C]</li><li>Adiabat : Mantle Adiabat [K/km]</li><li>MORside : side of the box where the MOR is located [&quot;left&quot;,&quot;right&quot;,&quot;front&quot;,&quot;back&quot;]</li><li>SpreadingVel : spreading velocity [cm/yr]</li><li>AgeRidge : thermal age of the ridge [Myrs]</li><li>maxAge : maximum thermal Age of plate [Myrs]</li></ul><p>Note: the thermal age at the mid oceanic ridge is set to 1 year to avoid division by zero</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/a5b0188fa123523dd7c3e6c8c804087565d8f96b/src/Setup_geometry.jl#L1217-L1234">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.LithosphericTemp" href="#GeophysicalModelGenerator.LithosphericTemp"><code>GeophysicalModelGenerator.LithosphericTemp</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LithosphericTemp(Tsurface=0.0, Tpot=1350.0, dTadi=0.5,
                    ubound=&quot;const&quot;, lbound=&quot;const, utbf = 50.0e-3, ltbf = 10.0e-3,
                    age = 120.0, dtfac = 0.9, nz = 201,
                    rheology = example_CLrheology()
                )</code></pre><p>Calculates a 1D temperature profile [C] for variable thermal parameters including radiogenic heat source and     linearly interpolates the temperature profile onto the box. The thermal parameters are defined in     rheology and the structure of the lithosphere is define by LithosphericPhases().</p><p><strong>Parameters</strong></p><ul><li>Tsurface  : surface temperature [C]</li><li>Tpot      : potential mantle temperature [C]</li><li>dTadi     : adiabatic gradient [K/km]</li><li>ubound    : Upper thermal boundary condition [&quot;const&quot;,&quot;flux&quot;]</li><li>lbound    : Lower thermal boundary condition [&quot;const&quot;,&quot;flux&quot;]</li><li>utbf      : Upper thermal heat flux [W/m]; if ubound == &quot;flux&quot;</li><li>ltbf      : Lower thermal heat flux [W/m]; if lbound == &quot;flux&quot;</li><li>age       : age of the lithosphere [Ma]</li><li>dtfac     : Diffusion stability criterion to calculate T_age</li><li>nz        : Grid spacing for the 1D profile within the box</li><li>rheology  : Structure containing the thermal parameters for each phase [default example_CLrheology]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/a5b0188fa123523dd7c3e6c8c804087565d8f96b/src/Setup_geometry.jl#L1385-L1411">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.ConstantPhase" href="#GeophysicalModelGenerator.ConstantPhase"><code>GeophysicalModelGenerator.ConstantPhase</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ConstantPhase(phase=1)</code></pre><p>Sets a constant phase inside the box</p><p><strong>Parameters</strong></p><ul><li>phase : the value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/a5b0188fa123523dd7c3e6c8c804087565d8f96b/src/Setup_geometry.jl#L1609-L1617">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.compute_phase" href="#GeophysicalModelGenerator.compute_phase"><code>GeophysicalModelGenerator.compute_phase</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Phase = compute_phase(Phase, Temp, X, Y, Z, s::LithosphericPhases, Ztop)</code></pre><p>or</p><pre><code class="nohighlight hljs">Phase = compute_phase(Phase, Temp, Grid::AbstractGeneralGrid, s::LithosphericPhases)</code></pre><p>This copies the layered lithosphere onto the Phase matrix.</p><p><strong>Parameters</strong></p><ul><li>Phase - Phase array</li><li>Temp  - Temperature array</li><li>X     - x-coordinate array (consistent with Phase and Temp)</li><li>Y     - y-coordinate array (consistent with Phase and Temp)</li><li>Z     - Vertical coordinate array (consistent with Phase and Temp)</li><li>s     - LithosphericPhases</li><li>Ztop  - Vertical coordinate of top of model box</li><li>Grid  - Grid structure (usually obtained with read<em>LaMEM</em>inputfile)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/a5b0188fa123523dd7c3e6c8c804087565d8f96b/src/Setup_geometry.jl#L1647-L1666">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.LithosphericPhases" href="#GeophysicalModelGenerator.LithosphericPhases"><code>GeophysicalModelGenerator.LithosphericPhases</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LithosphericPhases(Layers=[10 20 15], Phases=[1 2 3 4], Tlab=nothing )</code></pre><p>This allows defining a layered lithosphere. Layering is defined from the top downwards.</p><p><strong>Parameters</strong></p><ul><li>Layers : The thickness of each layer, ordered from top to bottom. The thickness of the last layer does not have to be specified.</li><li>Phases : The phases of the layers, ordered from top to bottom.</li><li>Tlab   : Temperature of the lithosphere asthenosphere boundary. If specified, the phases at locations with T&gt;Tlab are set to Phases[end].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/a5b0188fa123523dd7c3e6c8c804087565d8f96b/src/Setup_geometry.jl#L1628-L1639">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.McKenzie_subducting_slab" href="#GeophysicalModelGenerator.McKenzie_subducting_slab"><code>GeophysicalModelGenerator.McKenzie_subducting_slab</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">McKenzie_subducting_slab</code></pre><p>Thermal structure by McKenzie for a subducted slab that is fully embedded in the mantle.</p><p><strong>Parameters</strong></p><ul><li><code>Tsurface</code>:     Top T [C]</li><li><code>Tmantle</code>:      Bottom T [C]</li><li><code>Adiabat</code>:      Adiabatic gradient in K/km</li><li><code>v_cm_yr</code>:      Subduction velocity [cm/yr]</li><li><code>κ</code>:            Thermal diffusivity [m2/s]</li><li><code>it</code>:           Number iterations employed in the harmonic summation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/a5b0188fa123523dd7c3e6c8c804087565d8f96b/src/Setup_geometry.jl#L1693-L1707">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.LinearWeightedTemperature" href="#GeophysicalModelGenerator.LinearWeightedTemperature"><code>GeophysicalModelGenerator.LinearWeightedTemperature</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LinearWeightedTemperature</code></pre><p>Structure that defined a linear average temperature between two temperature fields as a function of distance</p><p><strong>Parameters</strong></p><ul><li>w_min:        Minimum weight</li><li>w_max:        Maximum weight</li><li>crit_dist:    Critical distance</li><li>dir:          Direction of the averaging (<code>:X</code>, <code>:Y</code> or <code>:Z</code>)</li><li>F1:           First temperature field</li><li>F2:           Second temperature field</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/a5b0188fa123523dd7c3e6c8c804087565d8f96b/src/Setup_geometry.jl#L1766-L1780">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gravity_code/">« Gravity code</a><a class="docs-footer-nextpage" href="../lamem/">LaMEM »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Thursday 30 October 2025 09:04">Thursday 30 October 2025</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
