<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>23 - Build geometry from polygons · GeophysicalModelGenerator.jl</title><meta name="title" content="23 - Build geometry from polygons · GeophysicalModelGenerator.jl"/><meta property="og:title" content="23 - Build geometry from polygons · GeophysicalModelGenerator.jl"/><meta property="twitter:title" content="23 - Build geometry from polygons · GeophysicalModelGenerator.jl"/><meta name="description" content="Documentation for GeophysicalModelGenerator.jl."/><meta property="og:description" content="Documentation for GeophysicalModelGenerator.jl."/><meta property="twitter:description" content="Documentation for GeophysicalModelGenerator.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="GeophysicalModelGenerator.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeophysicalModelGenerator.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/">Overview</a></li><li><a class="tocitem" href="../Tutorial_Basic/">1 - Getting started</a></li><li><a class="tocitem" href="../tutorial_load3DSeismicData/">2 - 3D seismic tomography from ASCII</a></li><li><a class="tocitem" href="../tutorial_loadregular3DSeismicData_netCDF/">3 - 3D seismic tomography from netCDF</a></li><li><a class="tocitem" href="../Tutorial_MohoTopo_Spada/">4 - Visualize Moho topography</a></li><li><a class="tocitem" href="../tutorial_GMT_Topography/">5 - Create GMT-based topography</a></li><li><a class="tocitem" href="../tutorial_Coastlines/">6 - Coastlines</a></li><li><a class="tocitem" href="../tutorial_Screenshot_To_Paraview/">7 - Import screenshots</a></li><li><a class="tocitem" href="../tutorial_loadirregular3DSeismicData/">8 - Interpolate irregular 3D seismic tomography</a></li><li><a class="tocitem" href="../tutorial_GMT_Topography_GeologicalMap/">9 - ETOPO1 Topography and geological maps</a></li><li><a class="tocitem" href="../tutorial_ISC_data/">10 - ISC earthquake data</a></li><li><a class="tocitem" href="../tutorial_GPS/">11 - Plot GPS vectors</a></li><li><a class="tocitem" href="../tutorial_UTM/">12 - Read UTM data</a></li><li><a class="tocitem" href="../Tutorial_Votemaps/">13 - VoteMaps</a></li><li><a class="tocitem" href="../tutorial_local_Flegrei/">14 - Campi Flegrei</a></li><li><a class="tocitem" href="../Tutorial_LaPalma/">15 - La Palma volcano Model</a></li><li><a class="tocitem" href="../tutorial_time_Seismicity/">16 - Create movies</a></li><li><a class="tocitem" href="../Tutorial_FaultDensity/">17 - Fault Density Map</a></li><li><a class="tocitem" href="../Tutorial_AlpineData/">18 - Alpine data integration</a></li><li><a class="tocitem" href="../Tutorial_Jura/">19 - Jura tutorial</a></li><li><a class="tocitem" href="../Tutorial_NumericalModel_2D/">20 - 2D model setups</a></li><li><a class="tocitem" href="../Tutorial_NumericalModel_3D/">21 - 3D model setups</a></li><li><a class="tocitem" href="../Tutorial_VolcanoModel_3D/">22 - 3D model setups</a></li><li class="is-active"><a class="tocitem" href>23 - Build geometry from polygons</a><ul class="internal"><li><a class="tocitem" href="#Goal"><span>Goal</span></a></li><li><a class="tocitem" href="#Steps"><span>Steps</span></a></li></ul></li></ul></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../datastructures/">Data Structures</a></li><li><a class="tocitem" href="../dataimport/">Data Import</a></li><li><a class="tocitem" href="../projection/">Projection</a></li><li><a class="tocitem" href="../asagi_io/">ASAGI</a></li><li><a class="tocitem" href="../paraview_output/">Paraview output</a></li><li><a class="tocitem" href="../paraview_collection/">Paraview collection</a></li><li><a class="tocitem" href="../surfaces/">Surfaces</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><a class="tocitem" href="../visualise/">Visualisation</a></li><li><a class="tocitem" href="../gravity_code/">Gravity code</a></li><li><a class="tocitem" href="../geodynamic_setups/">Numerical model setups</a></li><li><a class="tocitem" href="../lamem/">LaMEM</a></li><li><a class="tocitem" href="../ptatin/">pTatin</a></li><li><a class="tocitem" href="../Tutorial_Chmy_MPI/">Chmy</a></li><li><a class="tocitem" href="../profile_processing/">Profile Processing</a></li><li><a class="tocitem" href="../gmsh/">Gmsh</a></li><li><a class="tocitem" href="../movies/">Movies</a></li></ul></li><li><a class="tocitem" href="../listfunctions/">List of functions</a></li><li><a class="tocitem" href="../authors/">Authors</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>23 - Build geometry from polygons</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>23 - Build geometry from polygons</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/main/docs/src/man/tutorial_Polygon_structures.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Adding-complex-geometries-to-a-model-setup-including-sedimentary-basins,-lithospheric-thinning-and-an-accretionary-prism"><a class="docs-heading-anchor" href="#Adding-complex-geometries-to-a-model-setup-including-sedimentary-basins,-lithospheric-thinning-and-an-accretionary-prism">Adding complex geometries to a model setup including sedimentary basins, lithospheric thinning and an accretionary prism</a><a id="Adding-complex-geometries-to-a-model-setup-including-sedimentary-basins,-lithospheric-thinning-and-an-accretionary-prism-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-complex-geometries-to-a-model-setup-including-sedimentary-basins,-lithospheric-thinning-and-an-accretionary-prism" title="Permalink"></a></h1><h2 id="Goal"><a class="docs-heading-anchor" href="#Goal">Goal</a><a id="Goal-1"></a><a class="docs-heading-anchor-permalink" href="#Goal" title="Permalink"></a></h2><p>This tutorial visualizes simplified geological as it is done here for a passive margin where lithospheric thinning, sedimentary basin and accretionary prism occur. The simplification is based on a polygon structure for a pseudo-3D model. While the structure can have a random shape in the <code>x</code>- and <code>z</code>-direction, in the <code>y</code>-direction only the extent is variable. </p><h2 id="Steps"><a class="docs-heading-anchor" href="#Steps">Steps</a><a id="Steps-1"></a><a class="docs-heading-anchor-permalink" href="#Steps" title="Permalink"></a></h2><h4 id="1.-Set-up-your-simplified-background-model"><a class="docs-heading-anchor" href="#1.-Set-up-your-simplified-background-model">1. Set up your simplified background model</a><a id="1.-Set-up-your-simplified-background-model-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Set-up-your-simplified-background-model" title="Permalink"></a></h4><p>Before adding specific geological features, a general simplified model setup is necessary. The construction is made by using the <code>add_box!</code> function. For the model the discontinuities are in 15, 45, 145, and 945 km depth.</p><pre><code class="language-julia hljs">using GeophysicalModelGenerator

# number of cells in every direction
nx = 100
ny = 100
nz = 200

# define domain size
x        = LinRange(0.0,800.0,nx)
y        = LinRange(0.0,800.0,ny)
z        = LinRange(-660,50,nz)
Cart     = CartData(xyz_grid(x, y, z))

# initialize phase and temperature matrix
Phase = fill(1,nx,ny,nz);
Temp = fill(1350.0, nx,ny,nz);

# add different phases: crust-&gt;2, Mantle Lithosphere-&gt;3 Mantle-&gt;1
add_box!(Phase, Temp, Cart; xlim=(0.0,800.0),ylim=(0.0,800.0), zlim=(-800.0,0.0), phase = LithosphericPhases(Layers=[15 30 100 800], Phases=[2 3 1 5], Tlab=1300 ), T=LinearTemp(Ttop=20, Tbot=1600))

# add air phase 0
add_box!(Phase, Temp, Cart; xlim=(0.0,800.0),ylim=(0.0,800.0), zlim=(0.0,50.0), phase = ConstantPhase(0), T=ConstantTemp(20.0))</code></pre><h4 id="2.-Add-polygon-structure"><a class="docs-heading-anchor" href="#2.-Add-polygon-structure">2. Add polygon structure</a><a id="2.-Add-polygon-structure-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Add-polygon-structure" title="Permalink"></a></h4><p>To include the geological structures of a passive margin into the model, we use polygons for depths of up to 150 km. In the example, the sediment basin shows a more trapezoidal (2D in <code>x</code>-/<code>z</code>-direction) shape, while the thinning of the plate has a more triangular (2D in <code>x</code>-/<code>z</code>-direction). More complex structures can be build using arbitrarily sized polygons in <code>x</code>- and <code>z</code>-direction, wheraes in the <code>y</code>-direction only the length can be varied (specified by two values). The <code>x</code>- and <code>z</code>-values of the points need to be in the same order for selecting the correct point (P1(1/3), P2(2/2) –&gt; xlim(1,2), ylim(3,2)).</p><pre><code class="language-julia hljs"># xlim: x-coordinates of the points, same ordering as zlim
# zlim: z-coordinates of the points, same ordering as xlim
# ylim: limits the object within the two ylim values
# unlimited number of points possible to create the polygon

# add sediment basin 
add_polygon!(Phase, Temp, Cart; xlim=(0.0,0.0, 160.0, 200.0),ylim=(100.0,300.0), zlim=(0.0,-10.0,-20.0,0.0), phase = ConstantPhase(8), T=LinearTemp(Ttop=20, Tbot=30));

# add thinning of the continental crust attached to the slab and its thickness 
add_polygon!(Phase, Temp, Cart; xlim=(0.0, 200.0, 0.0),ylim=(500.0,800.0), zlim=(-100.0,-150.0,-150.0), phase = ConstantPhase(5), T=LinearTemp(Ttop=1000, Tbot=1100));

# add accretionary prism 
add_polygon!(Phase, Temp, Cart; xlim=(800.0, 600.0, 800.0),ylim=(100.0,800.0), zlim=(0.0,0.0,-60.0), phase = ConstantPhase(8), T=LinearTemp(Ttop=20, Tbot=30));</code></pre><h4 id="3.-Export-final-model-setup-to-a-paraview-file"><a class="docs-heading-anchor" href="#3.-Export-final-model-setup-to-a-paraview-file">3. Export final model setup to a paraview file</a><a id="3.-Export-final-model-setup-to-a-paraview-file-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Export-final-model-setup-to-a-paraview-file" title="Permalink"></a></h4><p>For visualisation and comparison to actual measured data, the mode setup is saved to a paraview file.</p><pre><code class="language-julia hljs"># # Save data to paraview:
Cart = addfield(Cart,(;Phase, Temp))
write_paraview(Cart, &quot;Sedimentary_basin&quot;);</code></pre><p>After importing and looking at the file to paraview, some unresolved areas might be visible as they are visible in this model. That is due to the resolution and shape of the polygon. To reduce those artefacts an increase in resolution or a change of the polygon angle might help.</p><p><img src="../../assets/img/Tutorial_Polygon_structures.png" alt="Tutorial_Polygon_structures"/></p><p>If you want to run the entire example, you can find the .jl code <a href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/main/tutorial/Tutorial_polygon_geometry.jl">here</a></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Tutorial_VolcanoModel_3D/">« 22 - 3D model setups</a><a class="docs-footer-nextpage" href="../installation/">Installation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Thursday 30 October 2025 09:04">Thursday 30 October 2025</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
