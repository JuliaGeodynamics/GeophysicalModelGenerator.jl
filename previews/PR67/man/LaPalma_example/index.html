<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>14 - Cartesian Volcano Model · GeophysicalModelGenerator.jl</title><meta name="title" content="14 - Cartesian Volcano Model · GeophysicalModelGenerator.jl"/><meta property="og:title" content="14 - Cartesian Volcano Model · GeophysicalModelGenerator.jl"/><meta property="twitter:title" content="14 - Cartesian Volcano Model · GeophysicalModelGenerator.jl"/><meta name="description" content="Documentation for GeophysicalModelGenerator.jl."/><meta property="og:description" content="Documentation for GeophysicalModelGenerator.jl."/><meta property="twitter:description" content="Documentation for GeophysicalModelGenerator.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeophysicalModelGenerator.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/">Overview</a></li><li><a class="tocitem" href="../tutorial_load3DSeismicData/">1 - 3D seismic tomography from ASCII</a></li><li><a class="tocitem" href="../tutorial_loadregular3DSeismicData_netCDF/">2 - 3D seismic tomography from netCDF</a></li><li><a class="tocitem" href="../tutorial_MohoTopo/">3 - Visualize Moho topography</a></li><li><a class="tocitem" href="../tutorial_GMT_Topography/">4 - Create GMT-based topography</a></li><li><a class="tocitem" href="../tutorial_Coastlines/">5 - Coastlines</a></li><li><a class="tocitem" href="../tutorial_Screenshot_To_Paraview/">6 - Import screenshots</a></li><li><a class="tocitem" href="../tutorial_loadirregular3DSeismicData/">7 - Interpolate irregular 3D seismic tomography</a></li><li><a class="tocitem" href="../tutorial_GMT_Topography_GeologicalMap/">8 - ETOPO1 Topography and geological maps</a></li><li><a class="tocitem" href="../tutorial_ISC_data/">9 - ISC earthquake data</a></li><li><a class="tocitem" href="../tutorial_GPS/">10 - Plot GPS vectors</a></li><li><a class="tocitem" href="../tutorial_UTM/">11 - Read UTM data</a></li><li><a class="tocitem" href="../Tutorial_Votemaps/">12 - VoteMaps</a></li><li><a class="tocitem" href="../tutorial_local_Flegrei/">13 - Campi Flegrei</a></li><li class="is-active"><a class="tocitem" href>14 - Cartesian Volcano Model</a><ul class="internal"><li><a class="tocitem" href="#Aim"><span>Aim</span></a></li><li><a class="tocitem" href="#1.-Load-data"><span>1. Load data</span></a></li><li><a class="tocitem" href="#2.-Convert-data"><span>2. Convert data</span></a></li><li><a class="tocitem" href="#3.-Create-LaMEM-setup"><span>3. Create LaMEM setup</span></a></li></ul></li><li><a class="tocitem" href="../tutorial_time_Seismicity/">15 - Create movies</a></li></ul></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../datastructures/">Data Structures</a></li><li><a class="tocitem" href="../dataimport/">Data Import</a></li><li><a class="tocitem" href="../projection/">Projection</a></li><li><a class="tocitem" href="../paraview_output/">Paraview output</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><a class="tocitem" href="../visualise/">Visualisation</a></li><li><a class="tocitem" href="../gravity_code/">Gravity code</a></li><li><a class="tocitem" href="../lamem/">LaMEM</a></li><li><a class="tocitem" href="../profile_processing/">Profile Processing</a></li></ul></li><li><a class="tocitem" href="../listfunctions/">List of functions</a></li><li><a class="tocitem" href="../authors/">Authors</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>14 - Cartesian Volcano Model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>14 - Cartesian Volcano Model</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/main/tutorials/LaPalma_example.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="14-Create-a-Cartesian-Model-Setup-for-La-Palma"><a class="docs-heading-anchor" href="#14-Create-a-Cartesian-Model-Setup-for-La-Palma">14 - Create a Cartesian Model Setup for La Palma</a><a id="14-Create-a-Cartesian-Model-Setup-for-La-Palma-1"></a><a class="docs-heading-anchor-permalink" href="#14-Create-a-Cartesian-Model-Setup-for-La-Palma" title="Permalink"></a></h1><h2 id="Aim"><a class="docs-heading-anchor" href="#Aim">Aim</a><a id="Aim-1"></a><a class="docs-heading-anchor-permalink" href="#Aim" title="Permalink"></a></h2><p>In this tutorial, your will learn how to use real data to create a geodynamic model setup with LaMEM. We will use the data of the Cumbre Viejo eruption in La Palma, which is a volcanic island that erupted from mid september 2021 - december 2021. LaMEM is a cartesian geodynamic model, which implies that you will have to transfer the data from <code>GeoData</code> to <code>CartData</code>.</p><h2 id="1.-Load-data"><a class="docs-heading-anchor" href="#1.-Load-data">1. Load data</a><a id="1.-Load-data-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Load-data" title="Permalink"></a></h2><p>We will use two types of data to create the model</p><ol><li>Topography</li><li>Earthquake locations</li></ol><p>We start with loading the required packages, which includes <code>GMT</code> to download topography (an optional dependency for <code>GeophysicalModelGenerator</code>)</p><pre><code class="language-julia hljs">using GeophysicalModelGenerator, GMT</code></pre><p>In case you managed to install GMT on your machine, you can automatically download the topography with</p><pre><code class="language-julia hljs">Topo = ImportTopo(lon = [-18.7, -17.1], lat=[28.0, 29.2], file=&quot;@earth_relief_03s.grd&quot;)</code></pre><p>In case you did not manage that, we have prepared a JLD2 file <a href="https://seafile.rlp.net/f/03286a46a9f040a69b0f/?dl=1">here</a>. Download it, and doublecheck that you are in the same directory as the data file with:</p><pre><code class="language-julia hljs">pwd()</code></pre><p>Load the data:</p><pre><code class="language-julia hljs">Topo=load(&quot;Topo_LaPalma.jld2&quot;,&quot;Topo&quot;)</code></pre><p>Next, lets load the seismicity. We have prepared a file with earthquake locations up to early November (from <a href="https://www.ign.es/web/ign/portal/vlc-catalogo">https://www.ign.es/web/ign/portal/vlc-catalogo</a>). Download that <a href="https://seafile.rlp.net/f/03286a46a9f040a69b0f/?dl=1">here</a></p><pre><code class="language-julia hljs">data_all_EQ = load(&quot;EQ_Data.jld2&quot;,&quot;data_all_EQ&quot;)</code></pre><p>Write the data to paraview with</p><pre><code class="language-julia hljs">Write_Paraview(data_all_EQ,&quot;data_all_EQ&quot;,PointsData=true)
Write_Paraview(Topo,&quot;Topo&quot;)</code></pre><p>As earthquakes are point-wise data, you have to specify this. <img src="../../assets/img/TopoEQs_LaPalma_GeoData.png" alt="LaPalma_EQTopo_GeoData"/> Note that this data is not in &quot;easy&quot; coordinates (see coordinate axis in the plot, where <code>z</code> is <em>not</em> pointing upwards).</p><h2 id="2.-Convert-data"><a class="docs-heading-anchor" href="#2.-Convert-data">2. Convert data</a><a id="2.-Convert-data-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Convert-data" title="Permalink"></a></h2><p>In order to create model setups, it is helpful to first transfer the data to Cartesian. This requires us to first determine a <em>projection point</em>, that is fixed. Often, it is helpful to use the center of the topography for this. In the present example, we will center the model around La Palma itself:</p><pre><code class="language-julia hljs">proj = ProjectionPoint(Lon=-17.84, Lat=28.56)</code></pre><p>Once this is done you can convert the topographic data to the cartesian reference frame</p><pre><code class="language-julia hljs">EQ_cart   = Convert2CartData(data_all_EQ, proj);
Topo_cart = Convert2CartData(Topo, proj)</code></pre><p>It is important to realize that the cartesian coordinates of the topographic grid is no longer strictly orthogonal after this conversion. You don&#39;t notice that in the current example, as the model domain is rather small. In other cases, however, this is quite substantial (e.g., India-Asia collision zone). LaMEM needs an orthogonal grid of topography, which we can create with:</p><pre><code class="language-julia hljs">Topo_LaMEM = CartData(XYZGrid(-70:.2:70,-60:.2:70,0));
nothing #hide</code></pre><p>In a next step, the routine <code>ProjectCartData</code> projects a <code>GeoData</code> structure to a <code>CartData</code> struct</p><pre><code class="language-julia hljs">Topo_LaMEM = ProjectCartData(Topo_LaMEM, Topo, proj)</code></pre><p>Let&#39;s have a look at the data:</p><pre><code class="language-julia hljs">Write_Paraview(EQ_cart,&quot;EQ_cart&quot;,PointsData=true)
Write_Paraview(Topo_LaMEM,&quot;Topo_LaMEM&quot;)


#=</code></pre><h2 id="3.-Create-LaMEM-setup"><a class="docs-heading-anchor" href="#3.-Create-LaMEM-setup">3. Create LaMEM setup</a><a id="3.-Create-LaMEM-setup-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Create-LaMEM-setup" title="Permalink"></a></h2><p>In a next step, we need to read the LaMEM input file of the simulation. In particular, this will read the lateral dimensions of the grid and the number of control volumes (elements), you want to apply in every direction. The LaMEM input file can be downloaded <a href="../../scripts/LaPalma.dat">here</a>. Make sure you are in the same directory as the *.dat file &amp; execute the following command</p><pre><code class="language-julia hljs">Grid    = ReadLaMEM_InputFile(&quot;LaPalma.dat&quot;)</code></pre><p>The <code>LaMEM_grid</code> structure contains the number of elements in every direction and the number of markers in every cell. It also contains <code>Grid.X</code>, <code>Grid.Y</code>, <code>Grid.Z</code>, which are the coordinates of each of the markers in the 3 directions.</p><p>In a next step we need to give each of these points a <code>Phase</code> number (which is an integer, that indicates the type of the rock that point has), as well as the temperature (in Celsius).</p><pre><code class="language-julia hljs">Phases  = ones(Int32,size(Grid.X))*2;
Temp    = ones(Float64,size(Grid.X));
nothing #hide</code></pre><p>In this example we set the temperature based on the depth, assuming a constant geotherm. Depth is given in kilometers</p><pre><code class="language-julia hljs">Geotherm =  30;
Temp     =  -Grid.Z.*Geotherm;
nothing #hide</code></pre><p>Since we are in La Palma, we assume that temperatures are not less than 20 degrees. Moreover, in the mantle, we have the mantle adiabat (1350 C)</p><pre><code class="language-julia hljs">Temp[Temp.&lt;20]    .=  20;
Temp[Temp.&gt;1350]  .=  1350;
nothing #hide</code></pre><p>Because of lacking data, we have pretty much no idea where the Moho is in La Palma. Somewhat arbitrary, we assume it to be at 40 km depth, and set the rocks below that to &quot;mantle&quot;:</p><pre><code class="language-julia hljs">ind = findall( Grid.Z .&lt; -40);
Phases[ind] .= 3;
nothing #hide</code></pre><p>Everything above the free surface is assumed to be &quot;air&quot;</p><pre><code class="language-julia hljs">ind     =   AboveSurface(Grid, Topo_cart);
Phases[ind] .= 0;
nothing #hide</code></pre><p>And all &quot;air&quot; points that are below sea-level becomes &quot;water&quot;</p><pre><code class="language-julia hljs">ind = findall( (Phases.==0) .&amp; (Grid.Z .&lt; 0));
Phases[ind] .= 1;
nothing #hide</code></pre><p>You can interpret the seismicity in different ways. If you assume that there are fully molten magma chambers, there should be no earthquakes within the magma chamber (as stresses are liklely to be very small). If, however, this is a partially molten mush, extraction of melt of that mush will change the fluid pressure and may thus release build-up stresses. We will assume the second option in our model setup.</p><p>Looking at the seismicity, there is a swarm at around 35 km depth</p><pre><code class="language-julia hljs">AddSphere!(Phases,Temp,Grid, cen=(0,0,-35), radius=5, phase=ConstantPhase(5), T=ConstantTemp(1200));
nothing #hide</code></pre><p>A shallower one exists as well</p><pre><code class="language-julia hljs">AddEllipsoid!(Phases,Temp,Grid, cen=(-1,0,-11), axes=(3,3,8), StrikeAngle=225, DipAngle=45, phase=ConstantPhase(5), T=ConstantTemp(1200));
nothing #hide</code></pre><p>And there might be a mid-crustal one</p><pre><code class="language-julia hljs">AddEllipsoid!(Phases,Temp,Grid, cen=(-0,0,-23), axes=(8,8,2), StrikeAngle=0, DipAngle=0, phase=ConstantPhase(5), T=ConstantTemp(1200));
nothing #hide</code></pre><p>We can generate a 3D model setup, which must include the <code>Phases</code> and <code>Temp</code> arrays</p><pre><code class="language-julia hljs">Model3D = CartData(Grid, (Phases=Phases,Temp=Temp))
Write_Paraview(Model3D,&quot;Model3D&quot;)</code></pre><p>The model setup looks like this <img src="../../assets/img/LaMEM_ModelSetup_LaPalma.png" alt="LaMEM_ModelSetup_LaPalma"/></p><p>We can create a LaMEM marker file from the <code>Model3D</code> setup and the (cartesian) topography</p><pre><code class="language-julia hljs">Save_LaMEMTopography(Topo_cart, &quot;Topography.txt&quot;)
Save_LaMEMMarkersParallel(Model3D)</code></pre><p>Next, you can use this to run the LaMEM model and visualize the model results in Paraview as well. If you are interested in doing this, have a look at the LaMEM <a href="https://bitbucket.org/bkaus/lamem/wiki/Home">wiki</a> pages.</p><pre><code class="language-julia hljs">=#</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial_local_Flegrei/">« 13 - Campi Flegrei</a><a class="docs-footer-nextpage" href="../tutorial_time_Seismicity/">15 - Create movies »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 29 February 2024 14:40">Thursday 29 February 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
