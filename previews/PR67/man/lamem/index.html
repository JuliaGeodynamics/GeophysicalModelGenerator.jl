<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>LaMEM · GeophysicalModelGenerator.jl</title><meta name="title" content="LaMEM · GeophysicalModelGenerator.jl"/><meta property="og:title" content="LaMEM · GeophysicalModelGenerator.jl"/><meta property="twitter:title" content="LaMEM · GeophysicalModelGenerator.jl"/><meta name="description" content="Documentation for GeophysicalModelGenerator.jl."/><meta property="og:description" content="Documentation for GeophysicalModelGenerator.jl."/><meta property="twitter:description" content="Documentation for GeophysicalModelGenerator.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeophysicalModelGenerator.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/">Overview</a></li><li><a class="tocitem" href="../tutorial_load3DSeismicData/">1 - 3D seismic tomography from ASCII</a></li><li><a class="tocitem" href="../tutorial_loadregular3DSeismicData_netCDF/">2 - 3D seismic tomography from netCDF</a></li><li><a class="tocitem" href="../tutorial_MohoTopo/">3 - Visualize Moho topography</a></li><li><a class="tocitem" href="../tutorial_GMT_Topography/">4 - Create GMT-based topography</a></li><li><a class="tocitem" href="../tutorial_Coastlines/">5 - Coastlines</a></li><li><a class="tocitem" href="../tutorial_Screenshot_To_Paraview/">6 - Import screenshots</a></li><li><a class="tocitem" href="../tutorial_loadirregular3DSeismicData/">7 - Interpolate irregular 3D seismic tomography</a></li><li><a class="tocitem" href="../tutorial_GMT_Topography_GeologicalMap/">8 - ETOPO1 Topography and geological maps</a></li><li><a class="tocitem" href="../tutorial_ISC_data/">9 - ISC earthquake data</a></li><li><a class="tocitem" href="../tutorial_GPS/">10 - Plot GPS vectors</a></li><li><a class="tocitem" href="../tutorial_UTM/">11 - Read UTM data</a></li><li><a class="tocitem" href="../Tutorial_Votemaps/">12 - VoteMaps</a></li><li><a class="tocitem" href="../tutorial_local_Flegrei/">13 - Campi Flegrei</a></li><li><a class="tocitem" href="../LaPalma_example/">14 - Cartesian Volcano Model</a></li><li><a class="tocitem" href="../tutorial_time_Seismicity/">15 - Create movies</a></li></ul></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../datastructures/">Data Structures</a></li><li><a class="tocitem" href="../dataimport/">Data Import</a></li><li><a class="tocitem" href="../projection/">Projection</a></li><li><a class="tocitem" href="../paraview_output/">Paraview output</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><a class="tocitem" href="../visualise/">Visualisation</a></li><li><a class="tocitem" href="../gravity_code/">Gravity code</a></li><li class="is-active"><a class="tocitem" href>LaMEM</a></li><li><a class="tocitem" href="../profile_processing/">Profile Processing</a></li></ul></li><li><a class="tocitem" href="../listfunctions/">List of functions</a></li><li><a class="tocitem" href="../authors/">Authors</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li class="is-active"><a href>LaMEM</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>LaMEM</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/main/docs/src/man/lamem.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="LaMEM"><a class="docs-heading-anchor" href="#LaMEM">LaMEM</a><a id="LaMEM-1"></a><a class="docs-heading-anchor-permalink" href="#LaMEM" title="Permalink"></a></h1><p>In order to generate geodynamic simulations from setups created with <code>GeophysicalModelGenerator.jl</code>, we provide a few routines that directly create marker input files for the 3D geodynamic modelling software <a href="https://bitbucket.org/bkaus/lamem">LaMEM</a>, which is an open-source cartesian code that is well-suited to perform crustal and lithospheric-scale simulations.  If you want to learn how to run LaMEM simulations, please have a look at the <a href="https://bitbucket.org/bkaus/lamem/wiki/Home">wiki page</a>. </p><p>The routines provided here have the following functionality:</p><ul><li>Read LaMEM *.dat files (to get the size of the domain)</li><li>Read LaMEM processor partitioning file</li><li>Add lithospheric boxes to a setup, that may have a layered structure and various thermal structures</li><li>Save LaMEM marker files in serial or in parallel</li><li>Read a LaMEM timestep</li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.ReadLaMEM_InputFile" href="#GeophysicalModelGenerator.ReadLaMEM_InputFile"><code>GeophysicalModelGenerator.ReadLaMEM_InputFile</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Grid::LaMEM_grid = ReadLaMEM_InputFile(file, args::Union{String,Nothing}=nothing)</code></pre><p>Parses a LaMEM input file and stores grid information in the <code>Grid</code> structure. Optionally, you can pass LaMEM command-line arguments as well.</p><p><strong>Example 1</strong></p><pre><code class="language-julia hljs">julia&gt; Grid = ReadLaMEM_InputFile(&quot;SaltModels.dat&quot;)
LaMEM Grid:
nel         : (32, 32, 32)
marker/cell : (3, 3, 3)
markers     : (96, 96, 96)
x           ϵ [-3.0 : 3.0]
y           ϵ [-2.0 : 2.0]
z           ϵ [-2.0 : 0.0]</code></pre><p><strong>Example 2 (with command-line arguments)</strong></p><pre><code class="language-julia hljs">julia&gt; Grid = ReadLaMEM_InputFile(&quot;SaltModels.dat&quot;, args=&quot;-nel_x 64 -coord_x -4,4&quot;)
LaMEM Grid:
  nel         : (64, 32, 32)
  marker/cell : (3, 3, 3)
  markers     : (192, 96, 96)
  x           ϵ [-4.0 : 4.0]
  y           ϵ [-2.0 : 2.0]
  z           ϵ [-2.0 : 0.0]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/LaMEM_io.jl#L166-L196">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.GetProcessorPartitioning" href="#GeophysicalModelGenerator.GetProcessorPartitioning"><code>GeophysicalModelGenerator.GetProcessorPartitioning</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nProcX,nProcY,nProcZ, xc,yc,zc, nNodeX,nNodeY,nNodeZ = GetProcessorPartitioning(filename; is64bit=false)</code></pre><p>Reads a LaMEM processor partitioning file, used to create marker files, and returns the parallel layout. By default this is done for a 32bit PETSc installation, which will fail if you actually use a 64bit version.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/LaMEM_io.jl#L559-L565">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.Save_LaMEMTopography" href="#GeophysicalModelGenerator.Save_LaMEMTopography"><code>GeophysicalModelGenerator.Save_LaMEMTopography</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Save_LaMEMTopography(Topo::CartData, filename::String)</code></pre><p>This writes a topography file <code>Topo</code> for use in LaMEM, which should have size <code>(nx,ny,1)</code> and contain the field <code>:Topography</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/LaMEM_io.jl#L927-L931">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.Save_LaMEMMarkersParallel" href="#GeophysicalModelGenerator.Save_LaMEMMarkersParallel"><code>GeophysicalModelGenerator.Save_LaMEMMarkersParallel</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Save_LaMEMMarkersParallel(Grid::CartData; PartitioningFile=empty, directory=&quot;./markers&quot;, verbose=true, is64bit=false)</code></pre><p>Saves a LaMEM marker file from the <code>CartData</code> structure <code>Grid</code>. It must have a field called <code>Phases</code>, holding phase information (as integers) and optionally a field <code>Temp</code> with temperature info. It is possible to provide a LaMEM partitioning file <code>PartitioningFile</code>. If not, output is assumed to be for one processor. By default it is assumed that the partitioning file was generated on a 32bit PETSc installation. If <code>Int64</code> was used instead, set the flag.</p><p>The size of <code>Grid</code> should be consistent with what is provided in the LaMEM input file. In practice, the size of the mesh can be retrieved from a LaMEM input file using <code>ReadLaMEM_InputFile</code>.</p><p><strong>Example</strong></p><pre><code class="nohighlight hljs">julia&gt; Grid    = ReadLaMEM_InputFile(&quot;LaMEM_input_file.dat&quot;)
julia&gt; Phases  = zeros(Int32,size(Grid.X));
julia&gt; Temp    = ones(Float64,size(Grid.X));
julia&gt; Model3D = CartData(Grid, (Phases=Phases,Temp=Temp))
julia&gt; Save_LaMEMMarkersParallel(Model3D)
Writing LaMEM marker file -&gt; ./markers/mdb.00000000.dat</code></pre><p>If you want to create a LaMEM input file for multiple processors:</p><pre><code class="nohighlight hljs">julia&gt; Save_LaMEMMarkersParallel(Model3D, PartitioningFile=&quot;ProcessorPartitioning_4cpu_1.2.2.bin&quot;)
Writing LaMEM marker file -&gt; ./markers/mdb.00000000.dat
Writing LaMEM marker file -&gt; ./markers/mdb.00000001.dat
Writing LaMEM marker file -&gt; ./markers/mdb.00000002.dat
Writing LaMEM marker file -&gt; ./markers/mdb.00000003.dat</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/LaMEM_io.jl#L370-L397">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.ReadData_PVTR" href="#GeophysicalModelGenerator.ReadData_PVTR"><code>GeophysicalModelGenerator.ReadData_PVTR</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Data::ParaviewData = ReadData_PVTR(fname, dir)</code></pre><p>Reads a parallel, rectilinear, <code>*.vts</code> file with the name <code>fname</code> and located in <code>dir</code> and create a 3D <code>Data</code> struct from it.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">julia&gt; Data = ReadData_PVTR(&quot;Haaksbergen.pvtr&quot;, &quot;./Timestep_00000005_3.35780500e-01/&quot;)
ParaviewData
  size  : (33, 33, 33)
  x     ϵ [ -3.0 : 3.0]
  y     ϵ [ -2.0 : 2.0]
  z     ϵ [ -2.0 : 0.0]
  fields: (:phase, :density, :visc_total, :visc_creep, :velocity, :pressure, :temperature, :dev_stress, :strain_rate, :j2_dev_stress, :j2_strain_rate, :plast_strain, :plast_dissip, :tot_displ, :yield, :moment_res, :cont_res)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/LaMEM_io.jl#L817-L832">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.AddBox!" href="#GeophysicalModelGenerator.AddBox!"><code>GeophysicalModelGenerator.AddBox!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AddBox!(Phase, Temp, Grid::AbstractGeneralGrid; xlim=Tuple{2}, [ylim=Tuple{2}], zlim=Tuple{2},
        Origin=nothing, StrikeAngle=0, DipAngle=0,
        phase = ConstantPhase(1),
        T=nothing )</code></pre><p>Adds a box with phase &amp; temperature structure to a 3D model setup.  This simplifies creating model geometries in geodynamic models</p><p><strong>Parameters</strong></p><ul><li>Phase - Phase array (consistent with Grid)</li><li>Temp  - Temperature array (consistent with Grid)</li><li>Grid -  grid structure (usually obtained with ReadLaMEM_InputFile, but can also be other grid types)</li><li>xlim -  left/right coordinates of box</li><li>ylim -  front/back coordinates of box [optional; if not specified we use the whole box]</li><li>zlim -  bottom/top coordinates of box</li><li>Origin - the origin, used to rotate the box around. Default is the left-front-top corner</li><li>StrikeAngle - strike angle of slab</li><li>DipAngle - dip angle of slab</li><li>phase - specifies the phase of the box. See <code>ConstantPhase()</code>,<code>LithosphericPhases()</code></li><li>T - specifies the temperature of the box. See <code>ConstantTemp()</code>,<code>LinearTemp()</code>,<code>HalfspaceCoolingTemp()</code>,<code>SpreadingRateTemp()</code>,<code>LithosphericTemp()</code></li></ul><p><strong>Examples</strong></p><p>Example 1) Box with constant phase and temperature &amp; a dip angle of 10 degrees:</p><pre><code class="language-julia hljs">julia&gt; Grid = ReadLaMEM_InputFile(&quot;test_files/SaltModels.dat&quot;)
LaMEM Grid:
  nel         : (32, 32, 32)
  marker/cell : (3, 3, 3)
  markers     : (96, 96, 96)
  x           ϵ [-3.0 : 3.0]
  y           ϵ [-2.0 : 2.0]
  z           ϵ [-2.0 : 0.0]
julia&gt; Phases = zeros(Int32,   size(Grid.X));
julia&gt; Temp   = zeros(Float64, size(Grid.X));
julia&gt; AddBox!(Phases,Temp,Grid, xlim=(0,500), zlim=(-50,0), phase=ConstantPhase(3), DipAngle=10, T=ConstantTemp(1000))
julia&gt; Model3D = ParaviewData(Grid, (Phases=Phases,Temp=Temp)); # Create Cartesian model
julia&gt; Write_Paraview(Model3D,&quot;LaMEM_ModelSetup&quot;)           # Save model to paraview
1-element Vector{String}:
 &quot;LaMEM_ModelSetup.vts&quot;</code></pre><p>Example 2) Box with halfspace cooling profile</p><pre><code class="language-julia hljs">julia&gt; Grid = ReadLaMEM_InputFile(&quot;test_files/SaltModels.dat&quot;)
julia&gt; Phases = zeros(Int32,   size(Grid.X));
julia&gt; Temp   = zeros(Float64, size(Grid.X));
julia&gt; AddBox!(Phases,Temp,Grid, xlim=(0,500), zlim=(-50,0), phase=ConstantPhase(3), DipAngle=10, T=ConstantTemp(1000))
julia&gt; Model3D = ParaviewData(Grid, (Phases=Phases,Temp=Temp)); # Create Cartesian model
julia&gt; Write_Paraview(Model3D,&quot;LaMEM_ModelSetup&quot;)           # Save model to paraview
1-element Vector{String}:
 &quot;LaMEM_ModelSetup.vts&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/Setup_geometry.jl#L19-L76">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.AddSphere!" href="#GeophysicalModelGenerator.AddSphere!"><code>GeophysicalModelGenerator.AddSphere!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AddSphere!(Phase, Temp, Grid::AbstractGeneralGrid; cen=Tuple{3}, radius=Tuple{1},
        phase = ConstantPhase(1).
        T=nothing )</code></pre><p>Adds a sphere with phase &amp; temperature structure to a 3D model setup.  This simplifies creating model geometries in geodynamic models</p><p><strong>Parameters</strong></p><ul><li>Phase - Phase array (consistent with Grid)</li><li>Temp  - Temperature array (consistent with Grid)</li><li>Grid - LaMEM grid structure (usually obtained with ReadLaMEM_InputFile)</li><li>cen - center coordinates of sphere</li><li>radius - radius of sphere</li><li>phase - specifies the phase of the box. See <code>ConstantPhase()</code>,<code>LithosphericPhases()</code></li><li>T - specifies the temperature of the box. See <code>ConstantTemp()</code>,<code>LinearTemp()</code>,<code>HalfspaceCoolingTemp()</code>,<code>SpreadingRateTemp()</code></li></ul><p><strong>Example</strong></p><p>Sphere with constant phase and temperature:</p><pre><code class="language-julia hljs">julia&gt; Grid = ReadLaMEM_InputFile(&quot;test_files/SaltModels.dat&quot;)
LaMEM Grid:
  nel         : (32, 32, 32)
  marker/cell : (3, 3, 3)
  markers     : (96, 96, 96)
  x           ϵ [-3.0 : 3.0]
  y           ϵ [-2.0 : 2.0]
  z           ϵ [-2.0 : 0.0]
julia&gt; Phases = zeros(Int32,   size(Grid.X));
julia&gt; Temp   = zeros(Float64, size(Grid.X));
julia&gt; AddSphere!(Phases,Temp,Grid, cen=(0,0,-1), radius=0.5, phase=ConstantPhase(2), T=ConstantTemp(800))
julia&gt; Model3D = ParaviewData(Grid, (Phases=Phases,Temp=Temp)); # Create Cartesian model
julia&gt; Write_Paraview(Model3D,&quot;LaMEM_ModelSetup&quot;)           # Save model to paraview
1-element Vector{String}:
 &quot;LaMEM_ModelSetup.vts&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/Setup_geometry.jl#L225-L265">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.AddEllipsoid!" href="#GeophysicalModelGenerator.AddEllipsoid!"><code>GeophysicalModelGenerator.AddEllipsoid!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AddEllipsoid!(Phase, Temp, Grid::AbstractGeneralGrid; cen=Tuple{3}, axes=Tuple{3},
        Origin=nothing, StrikeAngle=0, DipAngle=0,
        phase = ConstantPhase(1).
        T=nothing )</code></pre><p>Adds an Ellipsoid with phase &amp; temperature structure to a 3D model setup.  This simplifies creating model geometries in geodynamic models</p><p><strong>Parameters</strong></p><ul><li>Phase - Phase array (consistent with Grid)</li><li>Temp  - Temperature array (consistent with Grid)</li><li>Grid - LaMEM grid structure (usually obtained with ReadLaMEM_InputFile)</li><li>cen - center coordinates of sphere</li><li>axes - semi-axes of ellipsoid in X,Y,Z</li><li>Origin - the origin, used to rotate the box around. Default is the left-front-top corner</li><li>StrikeAngle - strike angle of slab</li><li>DipAngle - dip angle of slab</li><li>phase - specifies the phase of the box. See <code>ConstantPhase()</code>,<code>LithosphericPhases()</code></li><li>T - specifies the temperature of the box. See <code>ConstantTemp()</code>,<code>LinearTemp()</code>,<code>HalfspaceCoolingTemp()</code>,<code>SpreadingRateTemp()</code></li></ul><p><strong>Example</strong></p><p>Ellipsoid with constant phase and temperature, rotated 90 degrees and tilted by 45 degrees:</p><pre><code class="language-julia hljs">julia&gt; Grid = ReadLaMEM_InputFile(&quot;test_files/SaltModels.dat&quot;)
LaMEM Grid:
  nel         : (32, 32, 32)
  marker/cell : (3, 3, 3)
  markers     : (96, 96, 96)
  x           ϵ [-3.0 : 3.0]
  y           ϵ [-2.0 : 2.0]
  z           ϵ [-2.0 : 0.0]
julia&gt; Phases = zeros(Int32,   size(Grid.X));
julia&gt; Temp   = zeros(Float64, size(Grid.X));
julia&gt; AddEllipsoid!(Phases,Temp,Grid, cen=(-1,-1,-1), axes=(0.2,0.1,0.5), StrikeAngle=90, DipAngle=45, phase=ConstantPhase(3), T=ConstantTemp(600))
julia&gt; Model3D = ParaviewData(Grid, (Phases=Phases,Temp=Temp)); # Create Cartesian model
julia&gt; Write_Paraview(Model3D,&quot;LaMEM_ModelSetup&quot;)           # Save model to paraview
1-element Vector{String}:
 &quot;LaMEM_ModelSetup.vts&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/Setup_geometry.jl#L288-L332">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.AddCylinder!" href="#GeophysicalModelGenerator.AddCylinder!"><code>GeophysicalModelGenerator.AddCylinder!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AddCylinder!(Phase, Temp, Grid::AbstractGeneralGrid; base=Tuple{3}, cap=Tuple{3}, radius=Tuple{1},
        phase = ConstantPhase(1).
        T=nothing )</code></pre><p>Adds a cylinder with phase &amp; temperature structure to a 3D model setup.  This simplifies creating model geometries in geodynamic models</p><p><strong>Parameters</strong></p><ul><li>Phase - Phase array (consistent with Grid)</li><li>Temp  - Temperature array (consistent with Grid)</li><li>Grid - Grid structure (usually obtained with ReadLaMEM_InputFile)</li><li>base - center coordinate of bottom of cylinder</li><li>cap - center coordinate of top of cylinder</li><li>radius - radius of the cylinder</li><li>phase - specifies the phase of the box. See <code>ConstantPhase()</code>,<code>LithosphericPhases()</code></li><li>T - specifies the temperature of the box. See <code>ConstantTemp()</code>,<code>LinearTemp()</code>,<code>HalfspaceCoolingTemp()</code>,<code>SpreadingRateTemp()</code></li></ul><p><strong>Example</strong></p><p>Cylinder with constant phase and temperature:</p><pre><code class="language-julia hljs">julia&gt; Grid = ReadLaMEM_InputFile(&quot;test_files/SaltModels.dat&quot;)
LaMEM Grid:
  nel         : (32, 32, 32)
  marker/cell : (3, 3, 3)
  markers     : (96, 96, 96)
  x           ϵ [-3.0 : 3.0]
  y           ϵ [-2.0 : 2.0]
  z           ϵ [-2.0 : 0.0]
julia&gt; Phases = zeros(Int32,   size(Grid.X));
julia&gt; Temp   = zeros(Float64, size(Grid.X));
julia&gt; AddCylinder!(Phases,Temp,Grid, base=(-1,-1,-1.5), cap=(1,1,-0.5), radius=0.25, phase=ConstantPhase(4), T=ConstantTemp(400))
julia&gt; Model3D = ParaviewData(Grid, (Phases=Phases,Temp=Temp)); # Create Cartesian model
julia&gt; Write_Paraview(Model3D,&quot;LaMEM_ModelSetup&quot;)           # Save model to paraview
1-element Vector{String}:
 &quot;LaMEM_ModelSetup.vts&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/Setup_geometry.jl#L372-L413">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.makeVolcTopo" href="#GeophysicalModelGenerator.makeVolcTopo"><code>GeophysicalModelGenerator.makeVolcTopo</code></a> — <span class="docstring-category">Function</span></header><section><div><p>makeVolcTopo(Grid::LaMEM_grid; center::Array{Float64, 1}, height::Float64, radius::Float64, crater::Float64,             base=0.0m, background=nothing)</p><p>Creates a generic volcano topography (cones and truncated cones)</p><p><strong>Parameters</strong></p><ul><li>Grid - LaMEM grid (created by ReadLaMEM_InputFile)</li><li>center - x- and -coordinates of center of volcano</li><li>height - height of volcano</li><li>radius - radius of volcano</li></ul><p><strong>Optional Parameters</strong></p><ul><li>crater - this will create a truncated cone and the option defines the radius of the flat top</li><li>base - this sets the flat topography around the volcano</li><li>background - this allows loading in a topography and only adding the volcano on top (also allows stacking of several cones to get a volcano with different slopes)</li></ul><p><strong>Example</strong></p><p>Cylinder with constant phase and temperature:</p><pre><code class="language-julia hljs">julia&gt; Grid = ReadLaMEM_InputFile(&quot;test_files/SaltModels.dat&quot;)
LaMEM Grid:
  nel         : (32, 32, 32)
  marker/cell : (3, 3, 3)
  markers     : (96, 96, 96)
  x           ϵ [-3.0 : 3.0]
  y           ϵ [-2.0 : 2.0]
  z           ϵ [-2.0 : 0.0]
julia&gt; Topo = makeVolcTopo(Grid, center=[0.0,0.0], height=0.4, radius=1.5, crater=0.5, base=0.1)
CartData
    size    : (33, 33, 1)
    x       ϵ [ -3.0 : 3.0]
    y       ϵ [ -2.0 : 2.0]
    z       ϵ [ 0.1 : 0.4]
    fields  : (:Topography,)
  attributes: [&quot;note&quot;]
julia&gt; Topo = makeVolcTopo(Grid, center=[0.0,0.0], height=0.8, radius=0.5, crater=0.0, base=0.4, background=Topo.fields.Topography)
CartData
    size    : (33, 33, 1)
    x       ϵ [ -3.0 : 3.0]
    y       ϵ [ -2.0 : 2.0]
    z       ϵ [ 0.1 : 0.8]
    fields  : (:Topography,)
  attributes: [&quot;note&quot;]
julia&gt; Write_Paraview(Topo,&quot;VolcanoTopo&quot;)           # Save topography to paraview
Saved file: VolcanoTopo.vts</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/Setup_geometry.jl#L472-L525">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.ConstantTemp" href="#GeophysicalModelGenerator.ConstantTemp"><code>GeophysicalModelGenerator.ConstantTemp</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ConstantTemp(T=1000)</code></pre><p>Sets a constant temperature inside the box</p><p><strong>Parameters</strong></p><ul><li>T : the value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/Setup_geometry.jl#L586-L594">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.LinearTemp" href="#GeophysicalModelGenerator.LinearTemp"><code>GeophysicalModelGenerator.LinearTemp</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LinearTemp(Ttop=0, Tbot=1000)</code></pre><p>Set a linear temperature structure from top to bottom</p><p><strong>Parameters</strong></p><ul><li>Ttop : the value @ the top</li><li>Tbot : the value @ the bottom</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/Setup_geometry.jl#L605-L615">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.HalfspaceCoolingTemp" href="#GeophysicalModelGenerator.HalfspaceCoolingTemp"><code>GeophysicalModelGenerator.HalfspaceCoolingTemp</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HalfspaceCoolingTemp(Tsurface=0, Tmantle=1350, Age=60, Adiabat=0)</code></pre><p>Sets a halfspace temperature structure in plate</p><p><strong>Parameters</strong></p><ul><li>Tsurface : surface temperature [C]</li><li>Tmantle : mantle temperature [C]</li><li>Age : Thermal Age of plate [Myrs]</li><li>Adiabat : Mantle Adiabat [K/km]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/Setup_geometry.jl#L631-L643">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.SpreadingRateTemp" href="#GeophysicalModelGenerator.SpreadingRateTemp"><code>GeophysicalModelGenerator.SpreadingRateTemp</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SpreadingRateTemp(Tsurface=0, Tmantle=1350, Adiabat=0, MORside=&quot;left&quot;,SpreadingVel=3, AgeRidge=0, maxAge=80)</code></pre><p>Sets a halfspace temperature structure within the box, combined with a spreading rate (which implies that the plate age varies)</p><p><strong>Parameters</strong></p><ul><li>Tsurface : surface temperature [C]</li><li>Tmantle : mantle temperature [C]</li><li>Adiabat : Mantle Adiabat [K/km]</li><li>MORside : side of the box where the MOR is located [&quot;left&quot;,&quot;right&quot;,&quot;front&quot;,&quot;back&quot;]</li><li>SpreadingVel : spreading velocity [cm/yr]</li><li>AgeRidge : thermal age of the ridge [Myrs]</li><li>maxAge : maximum thermal Age of plate [Myrs]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/Setup_geometry.jl#L668-L683">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.LithosphericTemp" href="#GeophysicalModelGenerator.LithosphericTemp"><code>GeophysicalModelGenerator.LithosphericTemp</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LithosphericTemp(Tsurface=0.0, Tpot=1350.0, dTadi=0.5, 
                    ubound=&quot;const&quot;, lbound=&quot;const, utbf = 50.0e-3, ltbf = 10.0e-3, 
                    age = 120.0, dtfac = 0.9, nz = 201, 
                    rheology = example_CLrheology() 
                )</code></pre><p>Calculates a 1D temperature profile [C] for variable thermal parameters including radiogenic heat source and      linearly interpolates the temperature profile onto the box. The thermal parameters are defined in      rheology and the structure of the lithosphere is define by LithosphericPhases().</p><p><strong>Parameters</strong></p><ul><li>Tsurface  : surface temperature [C]</li><li>Tpot      : potential mantle temperature [C]</li><li>dTadi     : adiabatic gradient [K/km]</li><li>ubound    : Upper thermal boundary condition [&quot;const&quot;,&quot;flux&quot;] </li><li>lbound    : Lower thermal boundary condition [&quot;const&quot;,&quot;flux&quot;]</li><li>utbf      : Upper thermal heat flux [W/m]; if ubound == &quot;flux&quot;</li><li>ltbf      : Lower thermal heat flux [W/m]; if lbound == &quot;flux&quot;</li><li>age       : age of the lithosphere [Ma]</li><li>dtfac     : Diffusion stability criterion to calculate T_age</li><li>nz        : Grid spacing for the 1D profile within the box</li><li>rheology  : Structure containing the thermal parameters for each phase [default example_CLrheology]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/Setup_geometry.jl#L729-L755">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.ConstantPhase" href="#GeophysicalModelGenerator.ConstantPhase"><code>GeophysicalModelGenerator.ConstantPhase</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ConstantPhase(phase=1)</code></pre><p>Sets a constant phase inside the box</p><p><strong>Parameters</strong></p><ul><li>phase : the value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/Setup_geometry.jl#L952-L960">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.Compute_Phase" href="#GeophysicalModelGenerator.Compute_Phase"><code>GeophysicalModelGenerator.Compute_Phase</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Phase = Compute_Phase(Phase, Temp, X, Y, Z, s::LithosphericPhases, Ztop)</code></pre><p>or</p><pre><code class="nohighlight hljs">Phase = Compute_Phase(Phase, Temp, Grid::AbstractGeneralGrid, s::LithosphericPhases)</code></pre><p>This copies the layered lithosphere onto the Phase matrix.</p><p><strong>Parameters</strong></p><ul><li>Phase - Phase array</li><li>Temp  - Temperature array</li><li>X     - x-coordinate array (consistent with Phase and Temp)</li><li>Y     - y-coordinate array (consistent with Phase and Temp)</li><li>Z     - Vertical coordinate array (consistent with Phase and Temp)</li><li>s     - LithosphericPhases</li><li>Ztop  - Vertical coordinate of top of model box</li><li>Grid  - Grid structure (usually obtained with ReadLaMEM_InputFile)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/Setup_geometry.jl#L991-L1010">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.LithosphericPhases" href="#GeophysicalModelGenerator.LithosphericPhases"><code>GeophysicalModelGenerator.LithosphericPhases</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LithosphericPhases(Layers=[10 20 15], Phases=[1 2 3 4], Tlab=nothing )</code></pre><p>This allows defining a layered lithosphere. Layering is defined from the top downwards.</p><p><strong>Parameters</strong></p><ul><li>Layers : The thickness of each layer, ordered from top to bottom. The thickness of the last layer does not have to be specified.</li><li>Phases : The phases of the layers, ordered from top to bottom.</li><li>Tlab   : Temperature of the lithosphere asthenosphere boundary. If specified, the phases at locations with T&gt;Tlab are set to Phases[end].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/Setup_geometry.jl#L972-L983">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.LaMEM_grid" href="#GeophysicalModelGenerator.LaMEM_grid"><code>GeophysicalModelGenerator.LaMEM_grid</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Structure that holds information about the LaMEM grid (usually read from an input file).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/LaMEM_io.jl#L15-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeophysicalModelGenerator.CreatePartitioningFile" href="#GeophysicalModelGenerator.CreatePartitioningFile"><code>GeophysicalModelGenerator.CreatePartitioningFile</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">CreatePartitioningFile(LaMEM_input::String, NumProc::Int64; LaMEM_dir::String=pwd(), LaMEM_options::String=&quot;&quot;, MPI_dir=&quot;&quot;, verbose=true)</code></pre><p>This executes LaMEM for the input file <code>LaMEM_input</code> &amp; creates a parallel partitioning file for <code>NumProc</code> processors. The directory where the LaMEM binary is can be specified; if not it is assumed to be in the current directory. Likewise for the <code>mpiexec</code> directory (if not specified it is assumed to be available on the command line).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/0a9b1dd9c1e159ff61db0c061bb89413895f2534/src/LaMEM_io.jl#L974-L981">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gravity_code/">« Gravity code</a><a class="docs-footer-nextpage" href="../profile_processing/">Profile Processing »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 29 February 2024 14:40">Thursday 29 February 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
