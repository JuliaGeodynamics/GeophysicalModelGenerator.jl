<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Projection · GeophysicalModelGenerator.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">GeophysicalModelGenerator.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/">Overview</a></li><li><a class="tocitem" href="../tutorial_load3DSeismicData/">3D seismic tomography from ASCII</a></li><li><a class="tocitem" href="../tutorial_loadregular3DSeismicData_netCDF/">3D seismic tomography from netCDF</a></li><li><a class="tocitem" href="../tutorial_MohoTopo/">Visualize Moho topography</a></li><li><a class="tocitem" href="../tutorial_GMT_Topography/">Create GMT-based topography</a></li><li><a class="tocitem" href="../tutorial_Coastlines/">Coastlines</a></li><li><a class="tocitem" href="../tutorial_Screenshot_To_Paraview/">Import screenshots</a></li><li><a class="tocitem" href="../tutorial_loadirregular3DSeismicData/">Interpolate irregular 3D seismic tomography</a></li><li><a class="tocitem" href="../tutorial_GMT_Topography_GeologicalMap/">ETOPO1 Topography and geological maps</a></li><li><a class="tocitem" href="../tutorial_ISC_data/">ISC earthquake data</a></li><li><a class="tocitem" href="../tutorial_GPS/">Plot GPS vectors</a></li><li><a class="tocitem" href="../tutorial_UTM/">Read UTM data</a></li><li><a class="tocitem" href="../Tutorial_Votemaps/">VoteMaps</a></li><li><a class="tocitem" href="../tutorial_local_Flegrei/">Kilometer-scale volcano</a></li><li><a class="tocitem" href="../LaPalma_example/">Generating LaMEM model</a></li><li><a class="tocitem" href="../tutorial_time_Seismicity/">Create movies</a></li></ul></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../datastructures/">Data Structures</a></li><li><a class="tocitem" href="../dataimport/">Data Import</a></li><li class="is-active"><a class="tocitem" href>Projection</a></li><li><a class="tocitem" href="../paraview_output/">Paraview output</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><a class="tocitem" href="../visualise/">Visualisation</a></li><li><a class="tocitem" href="../gravity_code/">Gravity code</a></li><li><a class="tocitem" href="../lamem/">LaMEM</a></li></ul></li><li><a class="tocitem" href="../listfunctions/">List of functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li class="is-active"><a href>Projection</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Projection</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/master/docs/src/man/projection.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Projecting-and-converting-data"><a class="docs-heading-anchor" href="#Projecting-and-converting-data">Projecting &amp; converting data</a><a id="Projecting-and-converting-data-1"></a><a class="docs-heading-anchor-permalink" href="#Projecting-and-converting-data" title="Permalink"></a></h1><p>Typically, you load a dataset by reading it into julia and either generating a <code>GeoData</code> structure (in case you have <code>longitude/latitude/depth</code> info), or as <code>UTMData</code> (in case the data is in <code>UTM coordinates</code>, which requires you to specify the zone &amp; hemisphere).</p><p>If you write the data to <code>Paraview</code>, it is internally converted to a Paraview structure (which involves <code>x,y,z</code> Cartesian Earth-Centered-Earth-Fixed (ECEF) coordinates using the <code>wgs84</code> ellipsoid). </p><p>Yet, if you do geodynamic calculations the chances are that the geodynamic code does not operate in spherical coordinates, but rather use cartesian ones. In that case you should transfer your data to the <code>CartData</code> structure, which requires you to specify a <code>ProjectionPoint</code> that is a point on the map that will later have the coordinates <code>(0,0)</code> in the <code>CartData</code> structure.</p><h4 id=".-Converting"><a class="docs-heading-anchor" href="#.-Converting">1. Converting</a><a id=".-Converting-1"></a><a class="docs-heading-anchor-permalink" href="#.-Converting" title="Permalink"></a></h4><p>Converting from one coordinate system to the other is straightforward. Let&#39;s use Europe as an example:</p><pre><code class="language-julia">julia&gt; using GeophysicalModelGenerator, GMT
julia&gt; Topo = ImportTopo(lon = [-10, 45], lat=[25, 50], file=&quot;@earth_relief_20m&quot;)
GeoData 
  size  : (165, 75, 1)
  lon   ϵ [ -10.0 : 44.666666666666664]
  lat   ϵ [ 25.0 : 49.666666666666664]
  depth ϵ [ -4.9855 km : 3.123 km]
  fields: (:Topography,)
julia&gt; Write_Paraview(Topo,&quot;Topo&quot;)
Saved file: Topo.vts</code></pre><p>The result is shown on the globe as:  <img src="../../assets/img/Topo_Europe_GeoData.png" alt="Topo_Europe_GeoData"/></p><p>You can convert this to UTM zone as:</p><pre><code class="language-julia">julia&gt; convert(UTMData, Topo)
UTMData 
  UTM zone : 29-38 North
    size   : (165, 75, 1)
    EW     ϵ [ 197181.31221507967 : 769155.4572884373]
    NS     ϵ [ 2.7649477474783654e6 : 5.505892073781423e6]
    depth  ϵ [ -4985.5 m : 3123.0 m]
    fields : (:Topography,)</code></pre><p>As the area is large, it covers a range of <code>UTM</code> zones (and every point has a UTM zone attached). Within each zone, the coordinates are approximately orthogonal. Plotting this to Paraview does <em>not</em> result in a sensible dataset.</p><p>Yet, what we could do instead is show all data with respect to a single UTM zone. For this, we have to select a point around which we project (in this case more or less in the center):</p><pre><code class="language-julia">julia&gt; p=ProjectionPoint(Lon=17.3, Lat=37.5)
ProjectionPoint(37.5, 17.3, 703311.4380385976, 4.152826288024972e6, 33, true)</code></pre><p>Projecting the <code>GeoData</code> set using this projection point is done with:</p><pre><code class="language-julia">julia&gt; Convert2UTMzone(Topo,p)
UTMData 
  UTM zone : 33-33 North
    size   : (165, 75, 1)
    EW     ϵ [ -2.0750691599137965e6 : 3.581351293385453e6]
    NS     ϵ [ 2.7649477474783654e6 : 5.938114212160672e6]
    depth  ϵ [ -4985.5 m : 3123.0 m]
    fields : (:Topography,)</code></pre><p>Whereas this is now in UTM Data (in meters), it is distorted.  <img src="../../assets/img/Topo_Europe_UTMData.png" alt="Topo_Europe_UTMData"/></p><p>Often it is more convenient to have this in <code>CartData</code>, which is done in a similar manner:</p><pre><code class="language-julia">julia&gt; Topo_Cart = Convert2CartData(Topo,p)
CartData 
    size   : (165, 75, 1)
    x      ϵ [ -2778.3805979523936 km : 2878.039855346856 km]
    y      ϵ [ -1387.8785405466067 km : 1785.2879241356998 km]
    z      ϵ [ -4.9855 km : 3.123 km]
    fields : (:Topography,)</code></pre><p>This shows that the model is ~5600 by 3000 km. <img src="../../assets/img/Topo_Europe_CartData.png" alt="Topo_Europe_CartData"/></p><p>Whereas this is ok to look at and compare with a LaMEM model setup, we cannot use it to perform internal calculations (or to generate a LaMEM model setup), because the <code>x</code> and <code>y</code> coordinates are distorted and not orthogonal. </p><h4 id=".-Projecting-data"><a class="docs-heading-anchor" href="#.-Projecting-data">2. Projecting data</a><a id=".-Projecting-data-1"></a><a class="docs-heading-anchor-permalink" href="#.-Projecting-data" title="Permalink"></a></h4><p>For use with LaMEM, you would need an orthogonal cartesian grid. From the last command above we get some idea on the area, so we can create this:</p><pre><code class="language-julia">julia&gt; Topo_Cart_orth  = CartData(XYZGrid(-2000:20:2000,-1000:20:1000,0))
CartData 
    size   : (201, 101, 1)
    x      ϵ [ -2000.0 km : 2000.0 km]
    y      ϵ [ -1000.0 km : 1000.0 km]
    z      ϵ [ 0.0 km : 0.0 km]
    fields : (:Z,)</code></pre><p>Next, we can project the topographic data (in <code>GeoData</code> format) on this orthogonal grid</p><pre><code class="language-julia">julia&gt; Topo_Cart_orth  = ProjectCartData(Topo_Cart_orth, Topo, p)
CartData 
    size   : (201, 101, 1)
    x      ϵ [ -2000.0 km : 2000.0 km]
    y      ϵ [ -1000.0 km : 1000.0 km]
    z      ϵ [ -4.485650671162607 km : 2.5909655318121865 km]
    fields : (:Topography,)
julia&gt; Write_Paraview(Topo_Cart_orth,&quot;Topo_Cart_orth&quot;);    </code></pre><p><img src="../../assets/img/Topo_Europe_CartData_Proj.png" alt="Topo_Europe_CartData_Proj"/> So this interpolates the topographic data from the <code>GeoData</code> to the orthogonal cartesian grid (which can be used with LaMEM, for example).</p><p>You can do similar projections with full 3D data sets or pointwise data. </p><h4 id=".-List-of-functions"><a class="docs-heading-anchor" href="#.-List-of-functions">3. List of functions</a><a id=".-List-of-functions-1"></a><a class="docs-heading-anchor-permalink" href="#.-List-of-functions" title="Permalink"></a></h4><article class="docstring"><header><a class="docstring-binding" id="GeophysicalModelGenerator.Convert2CartData" href="#GeophysicalModelGenerator.Convert2CartData"><code>GeophysicalModelGenerator.Convert2CartData</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">Convert2CartData(d::UTMData, proj::ProjectionPoint)</code></pre><p>Converts a <code>UTMData</code> structure to a <code>CartData</code> structure, which essentially transfers the dimensions to km</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/e83b4f104644d9027df5049ec9d0e754d6f573e3/src/data_types.jl#L717-L720">source</a></section><section><div><pre><code class="language-none">Convert2CartData(d::GeoData, proj::ProjectionPoint)</code></pre><p>Converts a <code>GeoData</code> structure to a <code>CartData</code> structure, which essentially transfers the dimensions to km</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/e83b4f104644d9027df5049ec9d0e754d6f573e3/src/data_types.jl#L735-L738">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GeophysicalModelGenerator.ProjectCartData" href="#GeophysicalModelGenerator.ProjectCartData"><code>GeophysicalModelGenerator.ProjectCartData</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">d_cart = ProjectCartData(d_cart::CartData, d::GeoData, p::ProjectionPoint)</code></pre><p>Projects all datafields from the GeoData struct <code>d</code> to the CartData struct <code>d_cart</code>, around the projection point <code>p</code>. <code>d_cart</code> <em>must</em> be an orthogonal cartesian grid (deformed doesn&#39;t work; use <code>Convert2CartData(d, proj)</code>, where <code>proj</code> is a projection point in that case).</p><p><strong>Note:</strong></p><ul><li>If <code>d_cart</code> and <code>d</code> are horizontal surfaces (3rd dimension has size==1), it also interpolates the depth coordinate.    </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/e83b4f104644d9027df5049ec9d0e754d6f573e3/src/transformation.jl#L7-L16">source</a></section><section><div><pre><code class="language-none">d_cart = ProjectCartData(d_cart::CartData, d::UTMData, p::ProjectionPoint)</code></pre><p>Projects all datafields from the UTMData struct <code>d</code> to the CartData struct <code>d_cart</code>, around the projection point <code>p</code>.     <code>d_cart</code> <em>must</em> be an orthogonal cartesian grid (deformed doesn&#39;t work; use <code>Convert2CartData(d, proj)</code>, where <code>proj</code> is a projection point in that case).</p><pre><code class="language-none"># Note:    
- If `d_cart` and `d` are horizontal surfaces (3rd dimension has size==1), it also interpolates the depth coordinate.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/e83b4f104644d9027df5049ec9d0e754d6f573e3/src/transformation.jl#L49-L59">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GeophysicalModelGenerator.Convert2UTMzone" href="#GeophysicalModelGenerator.Convert2UTMzone"><code>GeophysicalModelGenerator.Convert2UTMzone</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">Convert2UTMzone(d::GeoData, p::ProjectionPoint)</code></pre><p>Converts a <code>GeoData</code> structure to fixed UTM zone, around a given <code>ProjectionPoint</code>       This useful to use real data as input for a cartesian geodynamic model setup (such as in LaMEM). In that case, we need to project map coordinates to cartesian coordinates.     One way to do this is by using UTM coordinates. Close to the <code>ProjectionPoint</code> the resulting coordinates will be rectilinear and distance in meters. The map distortion becomes larger the further you are away from the center.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/e83b4f104644d9027df5049ec9d0e754d6f573e3/src/data_types.jl#L517-L524">source</a></section><section><div><pre><code class="language-none">Convert2UTMzone(d::CartData, proj::ProjectionPoint)</code></pre><p>This transfers a <code>CartData</code> dataset to a <code>UTMData</code> dataset, that has a single UTM zone. The point around which we project is <code>ProjectionPoint</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaGeodynamics/GeophysicalModelGenerator.jl/blob/e83b4f104644d9027df5049ec9d0e754d6f573e3/src/data_types.jl#L705-L709">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../dataimport/">« Data Import</a><a class="docs-footer-nextpage" href="../paraview_output/">Paraview output »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 24 June 2022 12:30">Friday 24 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
